Kyosu
=====

**KYOSU** is an unified implementation of the complex, quaternions, octonions and more generally all
\f$\mathbb{R}\f$-Cayley-Dickson algebras in an SIMD aware context provided by **EVE**

\note If you are not interested in quite exotics features as quaternion or octonion, but only in real and complex **KYOSU**
is still a library that provides a set of ~150 functions that can be used with real and complex in scalar or simd form
with no abstraction penalty. The list of them can be seen below.

The Cayley-Dickson construction scheme defines a new algebra as a Cartesian product of an algebra with itself,
 with multiplication defined in a specific way (different from the componentwise multiplication)
 and an involution known as conjugation.

We currently only implement the Cayley-Dickson algebras based on the IEEE float and double
 representations of real numbers.

Kyosu proper usable objects are all in the namespace `kyosu`.

Cayley-Dickson algebras
=======================

These are algebras over the real numbers with an involution named conjugation.
The product of an element by its conjugate is 'real' and its positive square root is a norm on the
vector space defined by the algebra.

Starting from the real numbers (supported by type T float or double) we define:

  - complex numbers (dimension 2)
  - quaternion      (dimension 4)
  - octonion        (dimension 8)

  - and more generally for any integral power of 2: N, the cayley_dickson algebra of dimension N

Let \f$\mathbb{K}\f$ be a Cayley-Dickson algebra of dimension N its elements can be mathematically written

\f$\displaystyle z=\sum_0^{N-1} z_i\;e_i\f$

where \f$e_0=1\f$ and \f$(e_i)_{i>1}\f$ satisfy \f$e_i^2 = -1\f$ and a proper multiplication table relating them.

@note Up to octonions these \f$(e_i)_{i<8}\f$ have (non indicial) standard names, namely : i, j, k, l, li, lj, lk.
And  \f$e_0\f$ is 1 and so is generally omitted.

In the documentation we will sometimes use the following notations:

 * \f$|z|\f$ is the absolute value (or modulus) of \f$z\f$, i.e. \f$\sqrt{\sum_0^{N-1} |z_i|^2}\f$.
 * \f$z_0\f$ is the real part of \f$z\f$.
 * \f$\underline{z}\f$ is the pure part of \f$z\f$ i.e. \f$\sum_1^{N-1} z_i\;e_i\f$.
 * If \f$I_z\f$ denotes \f$\pm\underline{z}/|\underline{z}|\f$ (with \f$\pm\f$ chosen to be the sign of \f$z_1\f$),
   the polar form of \f$z\f$ is \f$\rho e^{\theta\;I_z} = \rho(\cos\theta + I_z\sin\theta)\f$,
   \f$ \rho\f$ being the norm of \f$z\f$ and \f$\theta\f$ its argument. (Note the similarity with complex numbers:
   it is easy to see that \f$I_z^2=-1\f$).

These datas with different dimensions can be freely mixed with the obvious semantic that if N <M an element of
cayley_dickson<N> will be considered as having its components from N to M-1, null as an element of cayley_dickson<M>


Higher are the dimensions weirder are these algebras

   - real numbers is a commutative ordered field
   - complex      is a commutative field with no multiplication-compatible order
   - quaternion   is a non-commutative field
   - octonion     is a non associative (but alternative) division algebra

The functions [commutator](@ref kyosu::commutator ) (resp. [associator](@ref kyosu::associator ))
can be used to see if two (resp. three)  Cayley-Dickson value commute (resp. associate).

Greater dimensions are not even alternative but keep power-associativity which allows
to define most elementary functions.

@note Let us recall that alternative means that every subalgrebra generated by
      two elements is associative.


What does this implementation provide
======================================

All operators and functions implemented can receive a mix of scalar or simd of cayley-dickson and reals of various
dimensionnality and are defined in the namespace kyosu.

Of course the algebra operation +, -, * and / are provided, but as \ is not an usable **C++**
character as an operator, the left division `a \ b` is provided as the call ldiv(a,b).

Constructors
------------

complex and  quaternion can be constructed using callables facilities `complex` and `quaternion`.

complex can also be constructed from their polar representation\n
quaternion from various parametrizations of \f$\mathbb{R}^4\f$ or from \f$\mathbb{R}^3\f$ rotations:

  |                         |                                                                 |                                                             |
  |-------------------------|-----------------------------------------------------------------|-------------------------------------------------------------|
  | angle and axis          | [from_angle_axis](@ref kyosu::from_angle_axis )                 | [to_angle_axis](@ref kyosu::to_angle_axis )                 |
  | cylindrical             | [from_cylindrical](@ref kyosu::from_cylindrical )               | [to_cylindrical](@ref kyosu::to_cylindrical )               |
  | cylindrospherical       | [from_cylindrospherical](@ref kyosu::from_cylindrospherical )   | [to_cylindrospherical](@ref kyosu::to_cylindrospherical )   |
  | euler                   | [from_euler](@ref kyosu::from_euler )                           | [to_euler](@ref kyosu::to_euler )                           |
  | multipolar              | [from_multipolar](@ref kyosu::from_multipolar )                 | [to_multipolar](@ref kyosu::to_multipolar )                 |
  | rotation matrix         | [from_rotation_matrix](@ref kyosu::from_rotation_matrix )       | [to_rotation_matrix](@ref kyosu::to_rotation_matrix )       |
  | semipolar               | [from_semipolar](@ref kyosu::from_semipolar )                   | [to_semipolar](@ref kyosu::to_semipolar )                   |
  | spherical               | [from_spherical](@ref kyosu::from_spherical )                   | [to_spherical](@ref kyosu::to_spherical )                   |
  | two vectors             | [align](@ref kyosu::align )                                     |                                                             |

The third column references to the corresponding to_xxx version that gives back the
chosen representation from a quaternion input.

TODO cayley_dickson<N> construction by a function.

Operators
---------

Operators (as said before) `+`, `-`, `*` and `/` can be used in infix form and can mix cayley-dickson values of
 different dimensionalities. Of course the biggest dimensionlity is recovered in the output.

Prefix forms are also provided as `add`, `sub`, `multiply` and `div`. Also plus and minus for unary versions.

The left division sometimes necessary if the dimensionality is greater than 2 is given as `ldiv`.

The left multiplication to the left by i or -i (i*i=-1) can be done calling respectively muli and mulmi

Functions
---------

Most **KYOSU** callables are usable with all cayley_dickson types. The exceptions mainly being rotation related quaternion usage.

@warning  **EVE** callables that correspond to mathematical functions that
          are only defined on a proper part of the real axis as, for example, `acos` DOES NOT ever provide the same result
          if called in **EVE** or **KYOSU** context.

          eve::acos(2.0) wil returns a NaN value, but kyosu::acos(2.0) will return the pure imaginary
          complex number \f$i\;\log(2+\sqrt{3})\f$

          All these kinds of functions called with a floating value in the kyosu namespace will return a complex value.

  * callables usable with all cayley_dickson types

    Most **EVE** arithmetic and math functions are provided. In particular, real analytic functions of one variable
    can be quite naturally extended using the polar form described above from a mere complex implementation.

   |              |               |                 |            |                 |
   |--------------|---------------|-----------------|------------|-----------------|
   | [abs](@ref kyosu::abs )                   | [acos](@ref kyosu::acos )               | [acosh](@ref kyosu::acosh )           | [acospi](@ref kyosu::acospi )  | [acot](@ref kyosu::acot )            |
   | [acotpi](@ref kyosu::acotpi )             | [atanpi](@ref kyosu::atanpi )           | [acoth](@ref kyosu::acoth )           | [arg](@ref kyosu::arg )        | [acsc](@ref kyosu::acsc )            |
   | [acscpi](@ref kyosu::acscpi )             | [acsch](@ref kyosu::acsch )             | [asec](@ref kyosu::asec )             | [asecpi](@ref kyosu::asecpi )  | [asech](@ref kyosu::asech )          |
   | [asin](@ref kyosu::asin )                 | [asinpi](@ref kyosu::asinpi )           | [asinh](@ref kyosu::asinh )           | [atan](@ref kyosu::atan )      | [atanh](@ref kyosu::atanh )          |
   | [average](@ref kyosu::average )           | [beta](@ref kyosu::beta )               | [ceil](@ref kyosu::ceil )             | [chi](@ref kyosu::chi )        | [conj](@ref kyosu::conj )            |
   | [cos](@ref kyosu::cos )                   |                                         |                                       |                                |                                      |
   | [cosh](@ref kyosu::cosh )                 | [cospi](@ref kyosu::cospi )             | [cot](@ref kyosu::cot )               | [cotpi](@ref kyosu::cotpi )    | [coth](@ref kyosu::coth )            |
   | [convert](@ref kyosu::convert )           | [csc](@ref kyosu::csc )                 | [cscpi](@ref kyosu::cscpi )           | [csch](@ref kyosu::csch )      | [dec](@ref kyosu::dec )              |
   | [deta](@ref kyosu::deta )                 | [digamma](@ref kyosu::digamma )         | [dist](@ref kyosu::dist )             | [dot](@ref kyosu::dot )        | [erf](@ref kyosu::erf )              |
   | [erfcx](@ref kyosu::erfcx )               | [erfi](@ref kyosu::erfi )               | [eta](@ref kyosu::eta )               | [exp](@ref kyosu::exp )        | [exp10](@ref kyosu::exp10 )          |
   | [exp2](@ref kyosu::exp2 )                 | [exp_i](@ref kyosu::exp_i )             | [exp_ipi](@ref kyosu::exp_ipi )       | [expm1](@ref kyosu::expm1 )    | [expmx2](@ref kyosu::expmx2 )        |
   | [expx2](@ref kyosu::expx2 )               | [faddeeva](@ref kyosu::faddeeva )       | [fam](@ref kyosu::fam )               | [floor](@ref kyosu::floor )    | [fma](@ref kyosu::fma )              |
   | [fms](@ref kyosu::fms )                   | [fnma](@ref kyosu::fnma )               | [fnms](@ref kyosu::fnms )             | [frac](@ref kyosu::frac )      | [fsm](@ref kyosu::fsm )              |
   | [from_polar](@ref kyosu::from_polar )     | [horner](@ref kyosu::horner )           | [hypot](@ref kyosu::hypot )           | [if_else](@ref kyosu::if_else )| [inc](@ref kyosu::inc )              |
   | [ipart](@ref kyosu::ipart )               | [is_denormal](@ref kyosu::is_denormal ) | [is_equal](@ref kyosu::is_equal )     | [is_eqz](@ref kyosu::is_eqz )  | [is_finite](@ref kyosu::is_finite )  |
   | [is_infinite](@ref kyosu::is_infinite )   | [is_imag](@ref kyosu::is_imag )         | [is_nan](@ref kyosu::is_nan )         | [is_nez](@ref kyosu::is_nez )  | [is_not_denormal](@ref kyosu::is_not_denormal ) |
   | [is_not_equal](@ref kyosu::is_not_equal ) | [is_not_finite](@ref kyosu::is_not_finite ) | [is_not_infinite](@ref kyosu::is_not_finite ) | [is_not_nan](@ref kyosu::is_not_nan ) | [is_not_real](@ref kyosu::is_not_real ) |
   | [is_pure](@ref kyosu::is_pure )           | [is_real](@ref kyosu::is_real )         | [is_unitary](@ref kyosu::is_unitary ) | [jpart](@ref kyosu::jpart )    | [kpart](@ref kyosu::kpart )          |
   | [ldiv](@ref kyosu::ldiv )                 | [lambda](@ref kyosu::lambda )           | [lbeta](@ref kyosu::lbeta )           | [lerp](@ref kyosu::lerp )      | [lipart](@ref kyosu::lipart )        |
   | [ljpart](@ref kyosu::ljpart )             | [lkpart](@ref kyosu::lkpart )           | [log](@ref kyosu::log )               | [log2](@ref kyosu::log2 )      | [lpart](@ref kyosu::lpart )          |
   | [lipart](@ref kyosu::lipart )             | [ljpart](@ref kyosu::ljpart )           | [lkpart](@ref kyosu::lkpart )         | [lpnorm](@ref kyosu::lpnorm )  | [lrising_factorial](@ref kyosu::lrising_factorial ) |
   | [manhattan](@ref kyosu::manhattan )       | [minus](@ref kyosu::minus )             | [nearest](@ref kyosu::nearest )     | [oneminus](@ref kyosu::oneminus )| [pow](@ref kyosu::pow )              |
   | [pow1p](@ref kyosu::pow1p )               | [pow_abs](@ref kyosu::pow_abs )         | [powm1](@ref kyosu::powm1 )           | [proj](@ref kyosu::proj )      | [pure](@ref kyosu::imag )            |
   | [radinpi](@ref kyosu::radinpi )           | [real](@ref kyosu::real )               | [rec](@ref kyosu::rec )               | [reldist](@ref kyosu::reldist )| [reverse_horner](@ref kyosu::reverse_horner ) |
   | [rising_factorial](@ref kyosu::rising_factorial ) | [sec](@ref kyosu::sec )| [secpi](@ref kyosu::secpi ) |
   | [sech](@ref kyosu::sech )                 | [sign](@ref kyosu::sign )               | [sin](@ref kyosu::sin )               | [sinc](@ref kyosu::sinc )      | [sincos](@ref kyosu::sincos )        |
   | [sinpi](@ref kyosu::sinpi )               | [sinpicospi](@ref kyosu::sinpicospi )   | [sinh](@ref kyosu::sinh )      | [sinhcosh](@ref kyosu::sinhcosh )     | [slerp](@ref kyosu::slerp )          |
   | [sqr](@ref kyosu::sqr )                   | [sqr_abs](@ref kyosu::sqr_abs )         | [sqrt](@ref kyosu::sqrt )             | [tan](@ref kyosu::tan )        | [tanpi](@ref kyosu::tanpi )          |
   | [tanh](@ref kyosu::tanh )                 | [to_polar](@ref kyosu::to_polar )       | [tgamma](@ref kyosu::tgamma )         | [trunc](@ref kyosu::trunc )    | [zeta](@ref kyosu::zeta )            |

  * Bessel functions

     They deserve a separate list to avoid verbosity:

     * cylindrical Bessel functions: cyl_bessel_xxx are all defined for xxx being j0, j1, jn, y0, y1, yn, i0, i1, in, h1_0, h1_1, h1n, h2_0, h2_1, h2n, k1, k0, kn.
     * spherical   Bessel functions: sph_bessel_xxx are all defined for xxx being j0, j1, jn, y0, y1, yn, i1_0, i1_1, i1n, i2_0, i2_1, i2n, h1_0, h1_1, h1n, h2_0, h2_1 h2n, k1, k0, kn.

  * Callables usable with quaternion, complex and real only

    These functions are related to \f$\mathbb{R}^3\f$ rotations

    |           |            |            |
    |-----------|------------|------------|
    | [rot_angle](@ref kyosu::rot_angle) |  [rot_axis](@ref kyosu::rot_axis) | [rotate_vec](@ref kyosu::rotate_vec) |

  * Constant i, j, k and cinf are defined.

    * [i(as<Z>())](@ref kyosu::i) returns at least a complex of the same underlying type as Z or a value of the Z type;
    * [j(as<Z>())](@ref kyosu::j) and [k(as<Z>())](@ref kyosu::k) return a least a quaternion of the same underlying type as Z or a value of the Z type;
    * cinf(as<Z>()) returns at least a complex with nan real part and inf imaginary part, that can be roughly taken as a complex-infinity, in the sense that abs is infinite and arg is undefinite (nan), or a value of the Z type.
