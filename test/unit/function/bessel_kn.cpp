//======================================================================================================================
/*
  Kyosu - Complex Without Complexes
  Copyright : KYOSU Contributors & Maintainers
  SPDX-License-Identifier: BSL-1.0
*/
//======================================================================================================================
#include <kyosu/kyosu.hpp>
#include <test.hpp>

TTS_CASE_WITH ( "Check kyosu::cyl_bessel_kn integral positive order"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  auto constexpr N = 11;
  using a_t  = std::array<T, 16 >;
  using aN_t = std::array<a_t, N >;
  a_t re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
  a_t im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
  aN_t reresN16;
  aN_t imresN16;
  //res are taken from octave 9.2.0 besselj outputs
  int i=0;
  reresN16[i] = a_t{-7.6426863392141115e+01,-9.0002239400280288e+00,1.6688121409598665e+01,1.2406923086087012e+01,2.2888684274756770e+00,-2.6219327973230624e+00,-2.4999100901074733e+00,-5.2493653524130623e-01,1.3724600605442980e+00,8.0197726946517736e-02,-1.0143807229843078e-01,-5.4541055012629798e-02,-6.6883612791388694e-03,7.3999114785972863e-03,4.9614711732347619e-03,9.0129863623049551e-04,};
  imresN16[i] = a_t{-2.8619908354383703e+01,4.2472451857378672e+01,-1.6333205050745224e+01,-2.9368613253804234e+00,6.7379123108606311e+00,-3.1685626174100103e+00,-4.0163985317199308e-01,1.7212964277105582e+00,0.0000000000000000e+00,-3.5727745928533017e-01,9.2179460261976223e-02,1.5955542061226579e-02,-2.3792687755670724e-02,8.2085162874102127e-03,8.4212686907880188e-04,-2.1389224461818642e-03,};
  ++i; //1  2  1.000e+00
  reresN16[i] = a_t{-7.5558723336697170e+01,-1.0901783756590387e+01,1.5082490243488515e+01,1.2087694612551193e+01,2.8064705166867476e+00,-2.0364309730027270e+00,-2.3702856960439487e+00,-1.2321752235513028e+00,3.0559920334573265e+00,2.4568305523740397e-02,-1.2596578001410641e-01,-5.7496621196871787e-02,-5.3406902773497460e-03,8.2569869882903046e-03,5.1186584912694512e-03,8.3716066698756391e-04,};
  imresN16[i] = a_t{-2.4400320472609398e+01,4.0656258546036412e+01,-1.6748029094651155e+01,-1.8906987893469371e+00,6.1679526686719459e+00,-3.3016711308793130e+00,1.4576006614871148e-01,1.3476064107535497e+00,0.0000000000000000e+00,-4.5971947380118922e-01,9.0250054265010926e-02,2.2411626032691864e-02,-2.5739594203717093e-02,8.1597667029847352e-03,1.1307863283709636e-03,-2.2528858999184358e-03,};
  ++i; //2  2  2.000e+00
  reresN16[i] = a_t{-7.1969079270007995e+01,-1.5683393966879203e+01,1.0466294168141445e+01,1.0748175707345291e+01,3.8758917427989048e+00,-4.0451627051867489e-01,-1.3871137761167767e+00,-1.9986198478844575e+00,2.1745740283593154e+01,-3.5495344133093099e-01,-2.1599306055793810e-01,-6.4128726120274343e-02,5.9177725553375728e-05,1.1059920812797431e-02,5.5392221151187348e-03,6.0101021352945098e-04,};
  imresN16[i] = a_t{-1.2683509501122607e+01,3.4965859052136359e+01,-1.7316514091627536e+01,8.3661819724535313e-01,4.3427874804402400e+00,-3.1957333499958636e+00,1.3566078701770719e+00,-1.3325273444493084e+00,0.0000000000000000e+00,-8.4156523861025967e-01,6.3585420268451043e-02,4.6616485973025479e-02,-3.1692375622982084e-02,7.6873285860862006e-03,2.1150331597556389e-03,-2.6011826078990870e-03,};
  ++i; //3  2  3.000e+00
  reresN16[i] = a_t{-6.3398095945142771e+01,-2.0743140718808760e+01,3.7786330432919257e+00,7.7088917465203517e+00,4.1874000564195475e+00,1.3345916861218499e+00,8.8425625718645262e-01,6.1194636854248738e+00,2.9299919581469953e+02,-2.3684690543586404e+00,-4.1296667608690574e-01,-6.1306779671013244e-02,1.4487963130091701e-02,1.6417670763042964e-02,5.9887954199450404e-03,4.3734830851821721e-05,};
  imresN16[i] = a_t{3.5278035154898033e+00,2.5227141704076221e+01,-1.6378051359951002e+01,3.9054079422695622e+00,1.4289799635400391e+00,-1.8184125627627998e+00,1.1299895441055428e+00,-3.7062174171938067e+00,0.0000000000000000e+00,-1.4329430683598463e+00,-9.7785305188985844e-02,1.0486846741374450e-01,-4.1047622868930829e-02,5.5139497215588133e-03,4.1709983752767615e-03,-3.1857223573503878e-03,};
  ++i; //4  2  4.000e+00
  reresN16[i] = a_t{-4.8238011620979321e+01,-2.2625088204793681e+01,-2.7738906038028466e+00,3.2234038628141422e+00,2.5942970586940834e+00,1.0920389516720443e+00,9.5378206961135137e-02,4.5105108918941026e+00,5.8817296565775869e+03,-1.1759189809486388e+01,-6.5704334122827301e-01,3.9481564125719015e-03,4.9048598384438417e-02,2.4745047208440028e-02,5.7444049565152262e-03,-1.1406496008595471e-03,};
  imresN16[i] = a_t{1.9143230140252971e+01,1.2624339365385053e+01,-1.2489027033155670e+01,5.2714343125698431e+00,-1.1373159266235695e+00,3.7138315556227008e-01,-2.1115314920751378e+00,3.7987907064011360e+01,0.0000000000000000e+00,1.9650127193861220e+00,-8.0042186942248139e-01,2.2369155134132895e-01,-4.7927231938480426e-02,-1.6131802688769854e-03,7.9499414486533110e-03,-3.9324740393181894e-03,};
  ++i; //5  2  5.000e+00
  reresN16[i] = a_t{-2.7884376521690569e+01,-1.8952373308962059e+01,-6.2375339309869933e+00,-6.1620789567135792e-01,2.1975732267411335e-01,-6.7836228753598726e-01,-5.7613928972204915e+00,-2.6830889094056818e+02,1.5713912337121708e+05,-4.1545177414759699e+01,1.4885632392110426e-01,3.0755513329059081e-01,1.2187088628376008e-01,3.3854846837624547e-02,2.8812645559306255e-03,-3.4763804978906248e-03,};
  imresN16[i] = a_t{2.8237976018432040e+01,5.4668805363983630e-01,-6.1690220215992424e+00,3.7347903517694974e+00,-1.2798374452572332e+00,-1.1408107583204891e-01,4.4035837511848239e+00,-7.7393472132438291e+01,0.0000000000000000e+00,5.3463867047130186e+01,-3.2035082201088860e+00,3.8942958068283601e-01,-2.6172191544146940e-02,-2.0825871995263232e-02,1.4160853131974540e-02,-4.4970656291481517e-03,};
  ++i; //6  2  6.000e+00
  reresN16[i] = a_t{-7.6591210017572227e+00,-1.0744515108193536e+01,-5.2514828316384596e+00,-1.5161212486214848e+00,4.6547356350616520e-02,2.3692410309701857e+00,2.9163899683568022e+01,1.5968986876907352e+03,5.2438525086971503e+06,4.7834258352366064e+01,9.0092443088205627e+00,1.2955613420127927e+00,2.3744708087418620e-01,3.0961846905868309e-02,-7.0554934061797820e-03,-7.6578297682804164e-03,};
  imresN16[i] = a_t{2.7115185757131535e+01,-6.6432458982235154e+00,-4.8270220008419867e-01,1.0057224499083264e+00,-9.4365669344185887e-02,-1.1235032219788039e+00,1.0707746181893524e+01,-2.0081457316221331e+03,0.0000000000000000e+00,4.7701023502883544e+02,-8.2724847523584728e+00,2.3179832218620294e-01,1.1074115984136534e-01,-6.4598106174080586e-02,2.2351972813892274e-02,-3.8075500238442307e-03,};
  ++i; //7  2  7.000e+00
  reresN16[i] = a_t{5.6716874200662639e+00,-2.5451627983711442e+00,-2.1169551745992243e+00,-6.7648857238630078e-01,-4.6578534361364887e-02,-1.5549546304868915e+00,-3.0325225422681811e+01,1.3897755831947412e+04,2.0991123947125733e+08,3.1075217828724490e+03,5.5639163719645744e+01,3.4008414645014131e+00,2.5921784981887086e-01,-2.8620461264232462e-02,-3.2502534315784079e-02,-1.3966685331446821e-02,};
  imresN16[i] = a_t{1.7495765159653970e+01,-7.0905995105893416e+00,1.6555674500256292e+00,5.7519721980369420e-02,-1.2530196036619081e+00,8.8369276422781535e+00,-1.5706970646121960e+02,2.4751816669311582e+04,0.0000000000000000e+00,2.6285197271059460e+03,3.6851963464485360e+00,-2.3181867223996777e+00,5.7972515433870087e-01,-1.4261553872675850e-01,2.6587715473400997e-02,8.3784466869081357e-04,};
  ++i; //8  2  8.000e+00
  reresN16[i] = a_t{9.0493868852264683e+00,1.4958958988312283e+00,-2.7875449078178116e-01,-7.7036904929457217e-01,-3.0338503561176573e+00,-2.4752172718001454e+01,-7.2533577582599958e+02,-3.6422453754443646e+05,9.8011016945007114e+09,4.0200124828201122e+04,1.8622645749126028e+02,2.4408479860819652e+00,-5.9092285121594534e-01,-2.6076473144429047e-01,-8.3162653613470083e-02,-1.9949596135950438e-02,};
  imresN16[i] = a_t{6.1203462968888784e+00,-3.6898728332066764e+00,1.2245864524238168e+00,-4.1116414520409161e-01,1.9939077712132627e+00,-2.4652806413633950e+01,6.3795914567092848e+02,4.6231861422790585e+04,0.0000000000000000e+00,-2.8760041553366837e+03,2.3056703008008793e+02,-1.4722565863565054e+01,1.6599903315772653e+00,-2.0617301418035033e-01,3.5930962325304884e-03,1.4994794194494529e-02,};
  ++i; //9  2  9.000e+00
  reresN16[i] = a_t{5.8456076951729186e+00,1.7759292649864591e+00,5.1836174899908793e-01,1.3761796154743529e+00,1.1142819739901789e+01,1.5336312397513990e+02,6.3383124551929241e+03,1.3857315985213832e+06,5.2293533494617615e+11,3.0170048716578790e+05,-2.8003359662876284e+02,-3.8127247884114801e+01,-5.0336034950173616e+00,-8.4881155675715547e-01,-1.4508294851121112e-01,-1.3708787497776240e-02,};
  imresN16[i] = a_t{-7.1823079305712434e-01,-8.3183410019725146e-01,6.8595675843814274e-01,-1.0939535955314421e+00,3.8890078993942505e+00,-3.0223813023686880e+01,2.1428657758081922e+03,-5.2541072469658973e+06,0.0000000000000000e+00,-3.4198051214119641e+05,1.7788187025726777e+03,-4.8558514127063120e+01,2.3179702917229976e+00,6.8486369320349488e-02,-1.1074405018261560e-01,4.6628502798732804e-02,};
  ++i; //10  2  1.000e+01
  reresN16[i] = a_t{1.8705812785403750e+00,8.9390264746256931e-01,4.5731922785878609e-01,-2.2587762629493821e-01,-1.2985235503946626e+01,-2.9737303166534144e+02,-1.0006606156579363e+04,7.2563933165931553e+07,3.1385921198465086e+13,-3.2232009995047527e+05,-1.0351727294244087e+04,-2.8680419750546065e+02,-1.8075067170857675e+01,-1.5765592862961662e+00,-7.9453523118992064e-02,4.0440315000931162e-02,};
  imresN16[i] = a_t{-2.2763123028206493e+00,4.8120685443052869e-01,-8.0894671168981580e-01,4.8915569812233448e+00,-4.1929165340951684e+01,7.3195342206880173e+02,-5.1302154241651042e+04,5.4160663716198117e+07,0.0000000000000000e+00,-5.7960049979181942e+06,6.6675253493962655e+03,-1.7355114952110256e+01,-7.4410135482785300e+00,1.8495447284579840e+00,-4.3443759717196123e-01,9.5107038890459739e-02,};
  auto pr2 = tts::prec<T>()*2;
  using eve::spherical;
  using kyosu::kind_1;
  auto h =  eve::half(eve::as<T>());
  for(int j=0; j <= 15; ++j)
  {
    auto c = kyosu::complex(re[j], im[j]);
   auto fac = kyosu::sqrt(eve::pio_2(eve::as(kyosu::real(c)))*kyosu::rec(c));
    for(int i=0; i < N; ++i)
    {
      // std::cout<< "j " << j  << " c[" << i << "] = " << c << std::endl;
      auto res = kyosu::complex(reresN16[i][j], imresN16[i][j]);
      if( ((i < 7) || (sizeof(T) == 8 ) || kyosu::is_not_real(c)) ) // The limitation of these tests with float is due to some overflow pbs when z is real
      {
        TTS_RELATIVE_EQUAL(kyosu::bessel_k(i, c), res, pr2);
        TTS_RELATIVE_EQUAL(kyosu::bessel_k(-i, c), res, pr2);
        TTS_RELATIVE_EQUAL(kyosu::bessel_k[kind_1][spherical](i, c), kyosu::bessel_k[kind_1](i+h, c)*fac, tts::prec<T>());
        TTS_RELATIVE_EQUAL(kyosu::bessel_k[kind_1][spherical](-i, c), kyosu::bessel_k[kind_1](-i+h, c)*fac, tts::prec<T>());
      }
    }
  }
};


// TTS_CASE_WITH ( "Check kyosu::cyl_bessel_k2n integral negative order"
//               , kyosu::scalar_real_types
//               , tts::generate(tts::randoms(-10,10))
//               )
// <typename T>(T )
// {
//   auto constexpr N = 11;
//   using a_t  = std::array<T, 16 >;
//   using aN_t = std::array<a_t, N >;
//   a_t re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
//   a_t im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
//   aN_t reresN16;
//   aN_t imresN16;
//   //res are taken from octave 9.2.0 besselj outputs
//   int i=0;
//   reresN16[i] = a_t{2.1988399563106543e+02,2.4475379403286627e-04,-1.0949275587116509e+02,7.0926149688609519e-04,-1.2134577316119763e+01,-1.8269104646258683e-02,2.9718238932026955e+00,-1.3938490578596488e-01,9.7762624653829611e-01,1.6477670588097639e+00,5.7801144894856459e-02,-3.7706880470084005e+00,-1.7305844653144060e-03,-4.5587245103257374e+01,-7.0927339073308311e-04,4.7382830132773599e+01,};
//   imresN16[i] = a_t{-7.4457014389297478e+02,4.2222247912422257e-05,-5.4163840901549179e+01,-2.0501433281152636e-03,1.6547181744548173e+01,-9.6142660041630447e-03,2.9905093588667149e+00,2.1994852133809409e-01,8.0727357780451992e-01,-9.4200443654515464e-01,-2.8437721740099727e-02,-7.4893412346961954e+00,-6.1357907332358014e-03,1.5088797239958149e+01,7.1380035703526274e-05,2.9602274269542443e+02,};
//   ++i; //1   1.000e+00
//   reresN16[i] = a_t{7.0523479832421106e+02,-5.1966173198415601e-05,5.5399150676183154e+01,2.1622410773788087e-03,-1.4293275067061980e+01,1.1965620368655849e-02,-2.7447717452290470e+00,-2.8456976487589863e-01,1.4831881627310406e-01,1.2439613389157882e+00,3.8795396026071904e-02,6.3858212297139350e+00,6.5083649941374815e-03,-1.6483172127684213e+01,-1.0216956600761109e-04,-2.8058303011863615e+02,};
//   imresN16[i] = a_t{2.3270002447946945e+02,2.5546359367357779e-04,-1.0077752102748380e+02,8.4599647402696764e-04,-1.2068202214419697e+01,-1.9783141801227117e-02,1.7182840689151211e+00,-2.2214378917556191e-01,2.2931051383885306e+00,1.0227225644184332e+00,6.2808764715385101e-02,-4.0730198843794367e+00,-2.2101999076038947e-03,-4.1893920025793783e+01,-7.4389305617771583e-04,5.5828974027738006e+01,};
//   ++i; //2   2.000e+00
//   reresN16[i] = a_t{-2.6062987977228732e+02,-2.8891573129062945e-04,7.7439570407309688e+01,-1.3420171051577766e-03,1.1007420355218741e+01,2.4447423067843786e-02,-4.9358318011931945e-01,7.1864644910651909e-01,1.1165861949063943e-02,6.1891684452445705e-01,-7.5120551625320317e-02,4.1916787378180382e+00,3.9966314088709671e-03,3.1788783936210265e+01,8.5162344548977812e-04,-7.5479330354308104e+01,};
//   imresN16[i] = a_t{5.9525559255548148e+02,-8.6090427595642526e-05,5.6532027894327456e+01,2.5100761697729114e-03,-8.6960711104540440e+00,2.1298337302884680e-02,-1.6087700058335248e+00,-5.5738343376166943e-01,1.4480094011452358e+01,7.2076566204779957e-01,8.1954613487065897e-02,3.5689196342012823e+00,7.6337868490482077e-03,-1.8982358875840266e+01,-2.1219909877358444e-04,-2.3672784854038261e+02,};
//   ++i; //3   3.000e+00
//   reresN16[i] = a_t{-4.3839222678606467e+02,1.6209418671645398e-04,-5.2495198887278107e+01,-3.0993496031858090e-03,3.0927653448394108e+00,-4.7227180313352872e-02,6.9133718589254267e-01,1.2153451239071451e+00,5.5934304776041695e-04,1.4354036742287248e+00,-2.0809244376898994e-01,-7.5796543747351741e-01,-9.3425063496537404e-03,1.9108484965249893e+01,4.6522735070773610e-04,1.7276675144293495e+02,};
//   imresN16[i] = a_t{-2.7916828823734778e+02,-3.4818845981351228e-04,4.7263572093155709e+01,-2.5193596146696694e-03,8.0611004355900597e+00,3.1222769924867302e-02,3.9827129895859570e-01,3.4690397292141371e+00,1.9077481501430970e+02,-8.1902492937174798e-01,-6.9147377384545392e-02,2.9863995344143857e+00,8.4032908669999604e-03,1.8458130633375493e+01,1.0393486813124739e-03,-9.2790020841511421e+01,};
//   ++i; //4   4.000e+00
//   reresN16[i] = a_t{2.6650234123828983e+02,4.3358670846841432e-04,-2.0226599321273508e+01,5.1753968106418189e-03,-4.3973111290807525e+00,-2.8692219739690231e-02,5.3512447774165406e-01,-2.1176462546228901e+01,2.0999005910771326e-05,1.2302193900464740e+00,-1.1250998506976712e-01,-1.2892065616770967e+00,-1.8656904697100511e-02,-6.7021364664089909e+00,-1.2934974731900481e-03,9.5115597709332960e+01,};
//   imresN16[i] = a_t{-2.7035192818715944e+02,3.2009780121229029e-04,-4.1225260212972884e+01,-3.7759326820860960e-03,-7.4395173141316620e-02,-1.1829957593269830e-01,-4.8808926553638732e-01,-3.3367226164442110e-01,3.8010162062747440e+03,-7.4840514728492158e+00,-5.4674598860321133e-01,2.6898898165850565e-01,-1.0285834575150924e-02,1.5118028994589356e+01,1.0088319702565229e-03,1.0322900305302829e+02,};
//   ++i; //5   5.000e+00
//   reresN16[i] = a_t{1.2780234001788479e+02,-6.4501134377925205e-04,2.6177241625044850e+01,3.6256591642247803e-03,7.5287856711982182e-01,3.1294268575749501e-01,-3.0941248351648563e+00,5.9503670601168622e+01,6.3044940002188614e-07,-2.6450732005439693e+01,1.2556686441612321e+00,-4.8167077014139514e-01,4.1279600754146510e-03,-8.9417453302412504e+00,-2.1539356815015996e-03,-4.4707400631811439e+01,};
//   imresN16[i] = a_t{2.1843174698297722e+02,5.2637056627900434e-04,-3.1881007776727484e+00,1.1136832630761524e-02,-1.6700056224030755e+00,5.1693947369110642e-02,-1.2172360028254385e+00,-1.4859313380901500e+02,1.0116965735231226e+05,-3.4038058522211003e+01,-1.2713323332279289e+00,-5.4022433603405806e-01,-4.1675826898665704e-02,-7.9901645145370355e-03,-1.4974807308038073e-03,7.9216284061965538e+01,};
//   ++i; //6   6.000e+00
//   reresN16[i] = a_t{-1.5030062837380635e+02,-5.3585891236927969e-04,-3.4445287794317085e+00,-2.4269117718509849e-02,5.4912285608666045e-01,-5.5821846365150518e-01,1.3248857200135578e+00,1.0969666829647417e+03,1.5767594796476312e-08,-3.0367417202829989e+02,6.9010460685675215e+00,-5.9201488577650951e-01,8.8746707051043608e-02,-1.9232649224067928e+00,1.1676617075128300e-03,-5.2764794822912776e+01,};
//   imresN16[i] = a_t{3.3615368392083155e+01,-1.3087500263175051e-03,1.2982757436689853e+01,-1.1927303704998785e-03,5.9731642596306966e-01,8.0929545175629813e-01,1.4935707832595298e+01,1.0256864664407362e+03,3.3685208955374686e+06,-3.0452581111007380e+01,1.0548335384362815e+00,-1.6839690581673980e-01,-3.3713862060618327e-02,-3.7898433896068466e+00,-4.5043479485012746e-03,-7.9006914348141208e+00,};
//   ++i; //7   7.000e+00
//   reresN16[i] = a_t{1.1042217808307697e+01,2.6335292196836800e-03,-4.7759043409387463e+00,2.4850445904469057e-02,-2.0467619572083159e-01,-1.7081320197733632e+00,6.8539133756106921e+01,-1.5209225804669784e+04,8.5048885023285613e-09,-1.9783097868304035e+03,1.5502725387233061e+01,-1.0842043870243303e+00,1.8797055149071196e-01,9.5261034448667103e-01,9.0404562947955479e-03,-7.3202332118779596e+00,};
//   imresN16[i] = a_t{-8.4965323982120196e+01,-1.3824552617486017e-04,-3.8337108981328054e+00,-5.1158007911221118e-02,-3.1998942798127467e-01,-3.1216814023846520e+00,-4.2726833223774065e+01,7.2523044757584657e+03,1.3463966616414651e+08,1.6733676040259661e+03,2.8432973817947914e+01,1.6555837534075162e+00,1.5903960158804847e-01,-1.4479166108826389e+00,-1.3320863141409939e-03,-2.7411449506570069e+01,};
//   ++i; //8   8.000e+00
//   reresN16[i] = a_t{3.8068585292321998e+01,-1.6883603034587237e-03,2.2481347464713464e+00,9.4296375870191587e-02,-1.0325269512202457e+00,1.4786612728230278e+01,-4.3354254217101555e+02,-1.5200930609229943e+04,-3.6068825022539437e-09,-1.8309211076027646e+03,-6.8897911480235834e+01,2.8349180185067393e+00,-1.1796559632218066e-01,6.3839442455958673e-01,1.0946898238442063e-02,1.0428721315961420e+01,};
//   imresN16[i] = a_t{2.1414478984861770e+01,5.1141786952836072e-03,-1.0613245197418786e+00,1.1559142412008958e-01,4.2117781851833203e-01,-2.4354165195139638e-01,-2.5698993307729251e+02,-2.1959643330232380e+05,6.2798159000979691e+09,2.5592194317105586e+04,1.6016157977211319e+02,7.0223398847811316e+00,7.1425543146324133e-01,1.4603284668029054e-01,1.6512826010224715e-02,-8.9084967465938387e+00,};
//   ++i; //9   9.000e+00
//   reresN16[i] = a_t{-1.6332289724113984e+01,-9.0264125654248746e-03,4.6930271908627953e-02,-4.2426271531879883e-01,3.2723821927537791e+00,-3.2128832627233578e+01,-1.8242188159938584e+02,3.1279927505773003e+06,2.0307278554816495e-05,1.9206849546285294e+05,-1.0313508741492124e+03,3.1296478532021162e+01,-2.2013809845726184e+00,3.2773977588975173e-01,-2.3210316273706559e-02,5.6095280286780662e+00,};
//   imresN16[i] = a_t{1.2332826041697865e+01,-7.9219013660750074e-03,9.1251805241212591e-01,9.7282558270663344e-02,2.5327809847166654e+00,6.1681437164741979e+01,3.5737026819057019e+03,9.9464621568561555e+05,3.3478887500572778e+11,2.1771155579364079e+05,2.8385466078784765e+02,7.3946727972206592e+00,9.2949109876170588e-01,3.7812054377804272e-01,4.1151209934169743e-02,2.3035626482812028e+00,};
//   ++i; //10   1.000e+01
//   reresN16[i] = a_t{-1.8645741110323140e+00,2.6567871884739094e-02,-3.8800108951911211e-01,3.5071219842047568e-01,2.6101913209137191e+00,-2.0186369032412077e+02,2.5820346727252228e+04,-3.4834091902578406e+07,-1.1554052326231523e-05,3.6898513824160453e+06,-5.9946876527183713e+03,1.1581821230894789e+02,-7.2916563501828930e+00,7.9284922683196646e-01,-1.2338007674618542e-01,2.9327654263534830e-01,};
//   imresN16[i] = a_t{-8.6519845132097135e+00,-1.1975560538677621e-02,-2.8855317300295752e-01,-1.3581317117217391e+00,-1.6132937916968761e+01,-3.0477570066898443e+02,-1.2063955434322903e+04,4.2583748810418658e+07,2.0081052684443582e+13,2.0519534865998483e+05,-4.2882717175462076e+03,-9.9878706814944479e+01,-4.8780128534985954e+00,-2.3815086482581632e-01,-1.8188909505369088e-03,2.4489087963792731e+00,};
//   auto pr2 = tts::prec<T>()*2;
//   using kyosu::kind_2;
//   using eve::spherical;
//   auto h =  eve::half(eve::as<T>());
//   for(int j=0; j <= 15; ++j)
//   {
//     auto c = kyosu::complex(re[j], im[j]);
//     auto fac = kyosu::sqrt(eve::pio_2(eve::as(kyosu::real(c)))*kyosu::rec(c));
//     for(int i=0; i < N; ++i)
//     {
//       // std::cout<< "j " << j  << " c[" << i << "] = " << c << std::endl;
//       auto res = kyosu::complex(reresN16[i][j], imresN16[i][j]);
//       if( ((i < 7) || (sizeof(T) == 8 ) || kyosu::is_not_real(c)) ) // The limitation of these tests with float is due to some overflow pbs when z is real
//       {
//         TTS_RELATIVE_EQUAL(kyosu::bessel_k[kind_2](i, c), res, pr2);
//         TTS_RELATIVE_EQUAL(kyosu::bessel_k[kind_2](-i, c), res, pr2);
//         TTS_RELATIVE_EQUAL(kyosu::bessel_k[kind_2][spherical](i, c), kyosu::bessel_k[kind_2](i+h, c)*fac, tts::prec<T>());
//         TTS_RELATIVE_EQUAL(kyosu::bessel_k[kind_2][spherical](-i, c), kyosu::bessel_k[kind_2](-i+h, c)*fac, tts::prec<T>());
//       }
//     }
//   }
// };
