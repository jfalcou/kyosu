//======================================================================================================================
/*
  Kyosu - Complex Without Complexes
  Copyright : KYOSU Contributors & Maintainers
  SPDX-License-Identifier: BSL-1.0
*/
//======================================================================================================================
#include <kyosu/kyosu.hpp>
#include <test.hpp>

TTS_CASE_WITH ( "Check kyosu::cyl_bessel_jn over real"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  if constexpr(sizeof(T) == 8)
  {
    auto constexpr N = 10;
    using a_t  = std::array<T, 16 >;
    using aN_t = std::array<a_t, N >;
    a_t re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
    a_t im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
    aN_t reresN16;
    aN_t imresN16;
    //res are taken from octave 9.2.0 besselj outputs
    int i=0;
    reresN16[i] =a_t{ 1.0994202526415064e+02,-6.1341983313317947e+01,-5.4746063975984825e+01,-2.4044261702680984e+01,
                      -6.0684928660729174e+00,2.9977058536861101e-01,1.4526323450892247e+00,1.2105699167991699e+00,
                      9.7762624653829611e-01,9.3760847680602921e-01,5.2093811265580170e-01,-1.8812996608689940e+00,
                      -9.1376223975139936e+00,-2.2794495422622159e+01,-3.0901357559000331e+01,2.3691330128760768e+01};
    imresN16[i] =a_t{ -3.7228510471626828e+02,1.4028409127768685e+02,-2.7081735332448620e+01,-5.8721248887491999e+00,
                      8.2766564391210764e+00,-4.4090348541239575e+00,1.4871447363675161e+00,-2.2151388474886807e-01,
                      0.0000000000000000e+00,-4.9652994760912211e-01,1.8018640814286571e+00,-3.7356445016228856e+00,
                      3.7443514096768258e+00,7.5449934565437502e+00,-5.0929189487805978e+01,1.4801128402835954e+02};
    ++i;//1
    reresN16[i] = a_t{ 3.5261736422778330e+02,1.3532335888033961e+02,2.7699759768911626e+01,-4.2643934472523917e+00,-7.1432412137305779e+00,-3.8913705040901281e+00,-1.3789048590911068e+00,-2.7460991266929441e-01,1.4831881627310392e-01,6.1416033492290367e-01,1.6523034064338877e+00,3.2031348760663070e+00,2.8517423787225713e+00,-8.2409938315074083e+00,-4.9501671082782835e+01,-1.4029160913677495e+02};
    imresN16[i] = a_t{ 1.1634998451985952e+02,5.3381323679436136e+01,-5.0389099238087169e+01,2.2598019114443215e+01,-6.0329512052803871e+00,1.3571314467505077e-01,8.9917883078392957e-01,-5.3118857437264089e-01,0.0000000000000000e+00,3.6502802882708785e-01,-1.2914522061506584e-01,-2.0402821881931246e+00,8.6660326577272038e+00,-2.0946005568638384e+01,2.7077615612492497e+01,2.7914572954983136e+01};
    ++i;//2
    reresN16[i]= a_t{ -1.3031496812979023e+02,3.2945269613043862e+01,3.8719363779645107e+01,1.8406121149842818e+01,5.5045646155744805e+00,7.7822409981718632e-01,-1.8002082625311086e-01,-1.0534140052268921e-01,1.1165861949063953e-02,4.1579886943962120e-02,3.6939751351770811e-01,2.0935865359340018e+00,7.1209313192735504e+00,1.5895620959999437e+01,1.7204532188423347e+01,-3.7739577283583174e+01};
    imresN16[i]= a_t{ 2.9762783830780870e+02,-1.2028097202919852e+02,2.8265837203765557e+01,5.5795755603181973e-01,-4.3525806756942647e+00,2.4615846625086828e+00,-8.0817621263627215e-01,1.1438546592087158e-01,0.0000000000000000e+00,2.4739764151330637e-01,-9.0634595724225331e-01,1.7700507509640206e+00,-7.5554463467919764e-01,-9.4917405155340564e+00,4.4701251488144443e+01,-1.1836380787572048e+02};
    ++i;//3
    reresN16[i]= a_t{ -2.1919605735188543e+02,-9.5960840979291248e+01,-2.6247738329194586e+01,-2.7378058103703271e+00,1.5393339343214520e+00,1.0202733252675829e+00,2.8997624765608049e-01,2.5475755042412361e-02,5.5934304774884547e-04,-3.6205278008366759e-02,-2.3537006102627681e-01,-4.0238692508157325e-01,1.0681429205300328e+00,9.5538393761653744e+00,3.5934587414803339e+01,8.6383536700968776e+01};
    imresN16[i]= a_t{ -1.3958411626024673e+02,-8.6886578512935824e+00,2.3632376115841012e+01,-1.2354529719447493e+01,4.0308286393366100e+00,-8.2073931887899532e-01,5.9773558011556975e-02,1.0169309231131291e-02,0.0000000000000000e+00,4.6607480311600599e-02,-3.3645309594598694e-01,1.4894318344022419e+00,-4.5830124453744201e+00,9.2272714145788921e+00,-5.4326147358923178e+00,-4.6395096888105925e+01};
    ++i;//4
    reresN16[i]= a_t{ 1.3325119403160494e+02,1.0005740090245322e+01,-1.0112399962550210e+01,-6.3969905271829095e+00,-2.1944577243719254e+00,-4.7149568258417762e-01,-4.9645303956380185e-02,3.3066480812119636e-05,2.0999005912958305e-05,-1.0373280034260593e-02,-1.3185578218478813e-01,-6.6977885991329023e-01,-2.0502652899551310e+00,-3.3538947882464640e+00,3.5209432016533437e+00,4.7557729253201487e+01};
    imresN16[i]= a_t{ -1.3517604495384680e+02,6.6253771851967471e+01,-2.0612625355682660e+01,3.8425190700261274e+00,-2.5237032789511116e-02,-2.3700096163370990e-01,6.4563841283250906e-02,-3.6542692831483163e-03,0.0000000000000000e+00,1.0406334465956882e-03,-1.6746974695591582e-03,1.7376924001569499e-01,-1.5720071572475272e+00,7.5588451546678641e+00,-2.4310770615898615e+01,5.1614260738035156e+01};
    ++i;//5
    reresN16[i]= a_t{ 6.3901046992603824e+01,3.7830532270180555e+01,1.3088216004625144e+01,3.0233391445030575e+00,3.9691637750659975e-01,-8.6475431813866040e-04,-7.8457034433818285e-03,-3.6511579535395528e-04,6.3044326337710463e-07,-1.1253083422928653e-03,-2.1007802282891903e-02,-1.8631851868255195e-01,-1.0893202012393792e+00,-4.4728199891465596e+00,-1.2935992840178386e+01,-2.2354076702768499e+01};
    imresN16[i]= a_t{ 1.0921586659166587e+02,-1.8076127768698793e+01,-1.5954866548039313e+00,2.3020862097997821e+00,-8.5206963548529180e-01,1.7506264122418783e-01,-1.6364141503020541e-02,1.3947831418903580e-04,0.0000000000000000e+00,-9.5182638817546260e-04,2.6951151019627691e-02,-1.7431922964476801e-01,4.9889425801390147e-01,5.3498074975038743e-04,-7.1217402595386066e+00,3.9608148025967303e+01};
    ++i;//6
    reresN16[i]= a_t{ -7.5150272794497042e+01,-1.6774205606485197e+01,-1.7245385937594269e+00,3.8532301543242808e-01,2.1667368585162602e-01,4.3692279071176066e-02,3.3919273377217159e-03,2.3554242916728469e-05,1.5769532945203197e-08,-1.2393618081046237e-05,1.7896487737988820e-03,1.2514541639287041e-02,-4.7536215666767356e-02,-9.5493915065013302e-01,-6.2732145302882056e+00,-2.6382579683583547e+01};
    imresN16[i]= a_t{ 1.6807875893508044e+01,-1.6658003090952871e+01,6.4929420762420174e+00,-1.6433079885403183e+00,2.6906111309819886e-01,-2.2563594867886450e-02,1.0403307392035384e-04,2.5759619100302093e-05,0.0000000000000000e+00,-1.7322367600867587e-04,7.1918994544405267e-03,-7.8518965693057469e-02,4.7450282100604912e-01,-1.8879189699361580e+00,4.8149860454107820e+00,-3.9497543395068431e+00};
    ++i;//7
    reresN16[i]= a_t{ 5.5214031703539765e+00,-4.6890213078369971e+00,-2.3832709611303873e+00,-6.4530067912808908e-01,-1.0861422680256537e-01,-9.8757532548590359e-03,-2.6881615044509042e-04,1.1711443160916389e-06,3.3805443102187290e-10,1.1604577754531845e-05,1.2550080998620745e-03,1.9227464093215803e-02,1.3092572130598859e-01,4.9664444488145859e-01,7.5052475297590682e-01,-3.6592365109898823e+00};
    imresN16[i]= a_t{ -4.2482830632879846e+01,1.1099053932835650e+01,-1.9136504359488085e+00,1.4463364507802476e-01,2.1859733740392316e-02,-6.7378294832820722e-03,4.7556325329503715e-04,-2.4052596034398297e-06,0.0000000000000000e+00,-1.3153959390315560e-05,5.7661667874096074e-04,-9.4117805838491737e-03,1.0125281693417286e-01,-7.3057443283090695e-01,3.7144122643640509e+00,-1.3705044098616034e+01};
    ++i;//8
    reresN16[i]= a_t{ 1.9033809051171946e+01,5.5750278243701530e+00,1.1266076790556427e+00,1.4773927938813541e-01,9.1979108922733456e-03,-2.3984277049836789e-04,-4.1535819657333415e-05,-1.7904784944879332e-07,6.3405024842634843e-12,1.5479466305602426e-06,2.0221273156693787e-04,4.4738058546415060e-03,4.8005507207815004e-02,3.2819660930961858e-01,1.5669466055042394e+00,5.2162627495431160e+00};
    imresN16[i]= a_t{ 1.0706825788325380e+01,-7.9499210111005025e-02,-5.4332140571365473e-01,1.7762595566682887e-01,-3.0081067254156976e-02,2.5482081256175300e-03,-6.5035355740131176e-05,-1.3520648107285461e-08,0.0000000000000000e+00,-8.6084005255864629e-08,-9.9925034966946984e-05,2.3814779198598917e-03,-1.6626497379400747e-02,2.0990192849282829e-02,4.6593932178764280e-01,-4.4553223609434314e+00};
    ++i;//9
    reresN16[i]= a_t{ -8.1665688412599735e+00,-1.0324458578016977e+00,-8.0427299764857796e-03,2.7413972033342993e-02,5.5533396134875741e-03,4.4711614380605323e-04,9.6796902310541598e-06,3.1975857952962414e-09,1.0570147217965338e-13,9.0323247903168339e-08,7.3703351978694726e-06,1.5634925173736765e-04,3.5986437775441249e-03,5.1874045837796957e-02,4.5996379288527522e-01,2.8043832276695642e+00};
    imresN16[i]= a_t{ 6.1676347875111759e+00,-2.1159544716950078e+00,4.6371719101989550e-01,-6.7315443576628858e-02,5.7616771836878954e-03,-1.9851422600767962e-04,-7.5164291864994974e-07,1.0230773013912833e-08,0.0000000000000000e+00,8.1714303786711880e-08,-3.1936496006409441e-05,1.0585333683903282e-03,-1.3487171042650513e-02,9.7219335986761551e-02,-4.4375439241529974e-01,1.1471239463366805e+00};
//     ++i;
//     reresN16[i]= a_t{ -9.2945378069946427e-01,-5.5654463652021580e-01,-1.3762005408985431e-01,-2.0629599116397824e-02,-1.7848558532356923e-03,-6.7901907189656606e-05,-4.4441290433078812e-07,4.4739084830719597e-10,1.5858465157002424e-15,3.9133464867901946e-10,-2.6124248491522775e-06,-1.4351523349435534e-04,-2.2467942887287522e-03,-1.6383095767178162e-02,-5.2590310312067429e-02,1.3655007723611573e-01};
//     imresN16[i]= a_t{ -4.3261812621784550e+00,7.2249881349373990e-01,-7.5392360584650292e-02,2.4145390271178412e-03,4.5787959406437995e-04,-5.0158069394027434e-05,1.0072715695591406e-06,-3.6299101757673117e-10,0.0000000000000000e+00,8.6035082077564487e-09,-3.4022089623455758e-06,1.4465906663362226e-04,-2.6426081339425084e-03,2.9241512426902948e-02,-2.2181516452594596e-01,1.2204264468291262e+00};

    for(int j=0; j <= 15; ++j)
    {
      auto c = kyosu::complex(re[j], im[j]);
      for(int i=0; i < N; ++i)
      {
//        std::cout<< "j " << j  << " c[" << i << "] = " << c << std::endl;
        auto res = kyosu::complex(reresN16[i][j], imresN16[i][j]);
//        TTS_RELATIVE_EQUAL(kyosu::cyl_bessel_jn(i, c), res, tts::prec<T>()) << j <<  " <- " << c << '\n';
        TTS_RELATIVE_EQUAL(kyosu::bessel_j(i, c), res, tts::prec<T>()) << j <<  " <- " << c << '\n';
        TTS_RELATIVE_EQUAL(kyosu::bessel_j(-i, c), eve::sign_alternate(i)*res, tts::prec<T>()) << j <<  " <- " << c << '\n';
      }
    }
  }
};
