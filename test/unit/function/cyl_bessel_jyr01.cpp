//======================================================================================================================
/*
  Kyosu - Complex Without Complexes
  Copyright : KYOSU Contributors & Maintainers
  SPDX-License-Identifier: BSL-1.0
*/
//======================================================================================================================
#include <kyosu/kyosu.hpp>
#include <test.hpp>

TTS_CASE_WITH ( "Check kyosu::cyl_bessel_j over real"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  if constexpr(sizeof(T) == 8)
  {
    std::array<T, 16> re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
    std::array<T, 16> im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
    std::array<T, 16> reres0_3{2.6670589645255768e+02, 9.4907436335776225e+00, -3.6096068852899243e+01, -2.3902796408096446e+01, -9.1154593998884934e+00, -1.7544218020097182e+00, 5.5052166857553242e-01, 8.1024456206462059e-01, 6.1981486006106479e-01, 1.0253730458563570e+00, 1.2596621243863972e+00, -1.0288666040224381e-02, -6.4414673146395636e+00, -2.3615489300244285e+01, -5.0281727198053339e+01, -4.5410260357876183e+01};
    std::array<T, 16> imres0_3{-2.7991470315648706e+02, 1.5211061821800564e+02, -4.8860506829213108e+01, 5.7606584761266024e+00, 4.5268554134440873e+00, -4.0109660044478632e+00, 1.9712172289953007e+00, -7.2386814837700642e-01, 0.0000000000000000e+00, -1.4886052118969012e-01, 1.3967480697611325e+00, -4.1483340398176010e+00, 7.3893167947935918e+00, -3.4864867870990661e+00, -3.1400601588298528e+01, 1.4219086589424288e+02};//     std::array<T, 16> imres2{-1.3031491164249709e+02, -3.2945558528775152e+01, 3.8720206627664581e+01, -1.8407463166947977e+01, 5.5028557396442608e+00, -7.5377667674934246e-01,-3.1356235386620857e-01, 8.2398784962920835e-01, 0.0000000000000000e+00, 5.7733695758049497e-01, -4.4451806514302838e-01, 2.0980922018840360e+00, -7.1169346878646786e+00, 1.5893162976210826e+01, -1.7203680564977855e+01, -3.7739753070724930e+01};
    std::array<T, 16> reres0_5{3.3866138365991566e+02, 5.6395384848533197e+01, -1.8649714479326430e+01, -2.0599097437590963e+01, -9.9356508529780339e+00, -2.9055032150429758e+00, -1.5335482911702847e-01, 4.3011139823053424e-01, 4.3049351732812502e-01, 9.6790128289013189e-01, 1.5710699095600149e+00, 1.1923664225806452e+00, -3.8947910548240245e+00, -2.1254735697106742e+01, -5.6923691707102087e+01, -8.5749692050391516e+01};
    std::array<T, 16> imres0_5{-1.8078740713578222e+02, 1.4025057173579813e+02, -5.7200687599803587e+01, 1.2890336596299175e+01, 1.3577777663443111e+00, -3.1610598131276784e+00, 1.9664170538774211e+00, -8.4911067884579794e-01, 0.0000000000000000e+00, 6.0204606214281697e-02, 9.8007694066300433e-01, -3.9094384188314182e+00, 8.8610334868190463e+00, -1.0316590693357915e+01, -1.4611500070075142e+01, 1.2081543320528951e+02};
    std::array<T, 16> reres1_3{2.4785559085814918e+02, 1.3939866877692722e+02, 4.6512878160841680e+01, 6.8976362014315296e+00, -3.0117944510627339e+00, -2.9798954326419036e+00, -1.3969230029860971e+00, -3.6436135144785020e-01, 7.2060978984664043e-02, 3.8165085445145652e-01, 1.3416808786403081e+00, 3.4856561473067567e+00, 5.8230935549648333e+00, 1.2595400311333877e+00, -3.2008248723598911e+01, -1.3422088180299443e+02};
    std::array<T, 16> imres1_3{2.6122803336519127e+02, -1.6890252634097877e+01, -2.9634332962345489e+01, 2.0739844697320120e+01, -8.2258402586371560e+00, 1.9237742873069503e+00, 1.3206775421603201e-02, -2.0875383089528352e-01, 0.0000000000000000e+00, 3.9620416443538198e-01, -6.1126243652203593e-01, -5.9057064186648711e-01, 6.3782651283545135e+00, -2.1488378955922208e+01, 4.3917401690723025e+01, -3.4115159120353468e+01};
    std::array<T, 16> reres1_5{1.4559126736302517e+02, 1.2255976132301129e+02, 5.1918906381791004e+01, 1.2932865345080307e+01, 8.8177079895928046e-03, -1.9386350728185864e+00, -1.1408467778110460e+00, -3.2027691249446111e-01, 4.3309881918378326e-02, 2.5115830598729982e-01, 1.0632739102694522e+00, 3.3162573295872733e+00, 7.0112961677983741e+00, 6.9629397916085640e+00, -1.7606383529663248e+01, -1.1555755277635731e+02};
    std::array<T, 16> imres1_5{3.1964610449257452e+02, -5.9964011899548723e+01, -1.2109109286250103e+01, 1.6507886024439710e+01, -8.3047884821369120e+00, 2.6522405544869216e+00, -4.4933380220691937e-01, -4.3994272037834958e-02, 0.0000000000000000e+00, 3.7320184370263770e-01, -8.0961333595803775e-01, 2.9552227955916388e-01, 4.3621636166261135e+00, -1.9553739938525226e+01, 4.9682347913681880e+01, -6.9593631714975373e+01};


    std::vector<kyosu::complex_t<T>> jsa(6), ysa(6);
    std::vector<kyosu::complex_t<T>> jsb(6), ysb(6);
    for (int k = 0; k < 16; ++k)
    {
      auto c = kyosu::complex(re[k], im[k]);
      kyosu::cyl_bessel_jy(3.3, c, jsa, ysa);
      kyosu::cyl_bessel_jy(3.5, c, jsb, ysb);
      auto ref0_3=  kyosu::complex_t<T>(reres0_3[k], imres0_3[k]);
      auto ref0_5=  kyosu::complex_t<T>(reres0_5[k], imres0_5[k]);
      auto ref1_3=  kyosu::complex_t<T>(reres1_3[k], imres1_3[k]);
      auto ref1_5=  kyosu::complex_t<T>(reres1_5[k], imres1_5[k]);
      TTS_RELATIVE_EQUAL(ref0_3, jsa[0], 1.0e-6) << "k " << k  << " c "<< c << '\n';
      TTS_RELATIVE_EQUAL(ref0_5, jsb[0], 1.0e-6) << "k " << k  << " c "<< c << '\n';
      TTS_RELATIVE_EQUAL(ref1_3, jsa[1], 1.0e-6) << "k " << k  << " c "<< c << '\n';
      TTS_RELATIVE_EQUAL(ref1_5, jsb[1], 1.0e-6) << "k " << k  << " c "<< c << '\n';
    }
  }
};

TTS_CASE_WITH ( "Check kyosu::cyl_bessel_y over real"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  if constexpr(sizeof(T) == 8)
  {
    std::array<T, 16> re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
    std::array<T, 16> im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
    std::array<T, 16> reres0_3{2.7991461947362251e+02, 1.5211046829490763e+02, 4.8860549618763294e+01, 5.7621667274152362e+00, -4.5202516270197606e+00, -3.9938679636013941e+00, -1.9547295120011854e+00, -8.5844812224858358e-01, -1.1783297929294725e+00, -1.3483304297212673e-04, 1.3964038002878834e+00, 4.1609503482659944e+00, 7.3956178306071632e+00, 3.4883456602479659e+00, -3.1400344153388122e+01, -1.4219094534894310e+02};
    std::array<T, 16> imres0_3{2.6670587741977073e+02, -9.4905442585997442e+00, -3.6096800265304573e+01, 2.3904374135179118e+01, -9.1161304309063418e+00, 1.7424786785608539e+00, 6.1810029706257941e-01, -1.0423282593729093e+00, 0.0000000000000000e+00, 8.3983868757334745e-01, -1.1944505962040202e+00, -2.5749133406177689e-02, 6.4426895432835929e+00, -2.3614461111141988e+01, 5.0281058867837636e+01, -4.5410029001322492e+01};
    std::array<T, 16> reres0_5{1.8078732112004346e+02, 1.4025036526334537e+02, 5.7200496679183082e+01, 1.2891281099371023e+01, -1.3516424357327597e+00, -3.1406845194248274e+00, -1.9280875493625962e+00, -9.0395460176479214e-01, -1.3916685091753709e+00, -2.6289463856490675e-01, 9.6012950316843249e-01, 3.9169779151090012e+00, 8.8667427205992606e+00, 1.0318694079534410e+01, -1.4611048200569753e+01, -1.2081543854404525e+02};
    std::array<T, 16> imres0_5{3.3866139183603934e+02, -5.6395241431405381e+01, -1.8650428726109368e+01, 2.0601091594703963e+01, -9.9384136055549508e+00, 2.8995119582041688e+00, -9.3028792412081146e-02, -7.0757674597650155e-01, 0.0000000000000000e+00, 8.2705018204056280e-01, -1.5074755447021786e+00, 1.1735542221700943e+00, 3.8978903019114348e+00, -2.1254313819122938e+01, 5.6923128368045447e+01, -8.5749445721028067e+01};
    std::array<T, 16> reres1_3{-2.6122804992146752e+02, -1.6890460105909114e+01, 2.9633530912610642e+01, 2.0737982471873995e+01, 8.2244975573255683e+00, 1.9360877620977881e+00, 7.1997410794711503e-02, 2.0977196304625639e-01, -3.5607044111846555e+00, -7.1046470349412760e-01, -6.9149794331554260e-01, 5.7420676285742700e-01, 6.3774854259965013e+00, 2.1489650923996219e+01, 4.3918142922229983e+01, 3.4115403163791918e+01};
    std::array<T, 16> imres1_3{2.4785568119023995e+02, -1.3939884086934484e+02, 4.6512875040863968e+01, -6.8960700595022706e+00, -3.0192791016303588e+00, 3.0016480686079703e+00, -1.4291770670084973e+00, 1.9997118011844417e-01, 0.0000000000000000e+00, 5.1983175644162105e-01, -1.3297911830903635e+00, 3.4690619779358749e+00, -5.8158957070705961e+00, 1.2575712830475447e+00, 3.2008486047222021e+01, -1.3422078407547932e+02};
    std::array<T, 16> reres1_5{-3.1964609065576656e+02, -5.9964156088435566e+01, 1.2108325894958721e+01, 1.6505523161441491e+01, 8.3008396919493652e+00, 2.6567038899083499e+00, 5.2472502479355354e-01, 4.9157703856465368e-01, -5.0693885479126974e+00, -6.8582351115230367e-01, -8.9658932250766554e-01, -3.1693216358526033e-01, 4.3592713838444057e+00, 1.9554417958937776e+01, 4.9683007491798321e+01, 6.9593900355543681e+01};
    std::array<T, 16> imres1_5{1.4559136038052804e+02, -1.2255999779868465e+02, 5.1919174066445429e+01, -1.2931967913160628e+01, 1.8898182317963214e-03, 1.9648853782386269e+00, -1.2066268868182113e+00, 3.1383145179908156e-01, 0.0000000000000000e+00, 4.8476780408845288e-01, -1.0733206880732873e+00, 3.3041265209913924e+00, -7.0043200616600245e+00, 6.9606103964426174e+00, 1.7606838531458006e+01, -1.1555753010088431e+02};

    std::vector<kyosu::complex_t<T>> jsa(6), ysa(6);
    std::vector<kyosu::complex_t<T>> jsb(6), ysb(6);
    for (int k = 0; k < 16; ++k)
    {
      auto c = kyosu::complex(re[k], im[k]);
      kyosu::cyl_bessel_jy(3.3, c, jsa, ysa);
      kyosu::cyl_bessel_jy(3.5, c, jsb, ysb);
      auto ref0_3=  kyosu::complex_t<T>(reres0_3[k], imres0_3[k]);
      auto ref0_5=  kyosu::complex_t<T>(reres0_5[k], imres0_5[k]);
      auto ref1_3=  kyosu::complex_t<T>(reres1_3[k], imres1_3[k]);
      auto ref1_5=  kyosu::complex_t<T>(reres1_5[k], imres1_5[k]);
      TTS_RELATIVE_EQUAL(ref0_3, ysa[0], 1.0e-6) << "k " << k  << " c "<< c << '\n';
      TTS_RELATIVE_EQUAL(ref0_5, ysb[0], 1.0e-6) << "k " << k  << " c "<< c << '\n';
      TTS_RELATIVE_EQUAL(ref1_3, ysa[1], 1.1e-6) << "k " << k  << " c "<< c << '\n';
      TTS_RELATIVE_EQUAL(ref1_5, ysb[1], 1.1e-6) << "k " << k  << " c "<< c << '\n';
   }
  }
};
