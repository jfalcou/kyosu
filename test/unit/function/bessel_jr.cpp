//======================================================================================================================
/*
  Kyosu - Complex Without Complexes
  Copyright : KYOSU Contributors & Maintainers
  SPDX-License-Identifier: BSL-1.0
*/
//======================================================================================================================
#include <kyosu/kyosu.hpp>
#include <test.hpp>

TTS_CASE_WITH ( "Check kyosu::bessel_jr over real positive order"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  if constexpr(sizeof(T) == 8)
  {
    auto constexpr N = 11;
    using a_t  = std::array<T, 16 >;
    using aN_t = std::array<a_t, N >;
    a_t re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
    a_t im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
    aN_t reresN16;
    aN_t imresN16;
    //res are taken from octave 9.2.0 besselj outputs
    int i=0;
    reresN16[i] = a_t{2.8090373106452773e+02,1.7536493250871054e+01,-3.3400462158788272e+01,-2.3524142528283910e+01,-9.3274540332656208e+00,-1.9656734427524503e+00,4.3413771695853465e-01,7.4917804310983560e-01,5.8501480583737409e-01,1.0213243250718731e+00,1.3227852389571668e+00,1.9818890844578396e-01,-6.0472153767481238e+00,-2.3374276615174153e+01,-5.1769656721627001e+01,-5.2626473557055462e+01,};
    imresN16[i] = a_t{-2.6513665958745401e+02,1.5122859663021515e+02,-5.0648785179729913e+01,7.0192828558358924e+00,4.0222943595848140e+00,-3.8995769510156886e+00,1.9902620949926999e+00,-7.5756275269309670e-01,0.0000000000000000e+00,-1.1158707376004939e-01,1.3330326497253218e+00,-4.1355677304829221e+00,7.6943469735731851e+00,-4.6838788665148172e+00,-2.8742293351241671e+01,1.3952363114976131e+02,};
    ++i; //1
    reresN16[i] = a_t{2.3218011507225017e+02,1.3762528365552757e+02,4.7847104525403608e+01,8.0151973007998834e+00,-2.5061680123548808e+00,-2.8237507733786065e+00,-1.3664633627662230e+00,-3.6135936405914593e-01,6.6295013865157307e-02,3.5820388606231091e-01,1.2977195521860816e+00,3.4754417946285550e+00,6.0681778089257774e+00,2.2666616116923430e+00,-2.9701344200578596e+01,-1.3184200984262824e+02,};
    imresN16[i] = a_t{2.7341623172800087e+02,-2.4492392273846086e+01,-2.6835634189280519e+01,2.0182267073967573e+01,-8.3177712814563360e+00,2.0759039059106743e+00,-7.4368575761549427e-02,-1.7741284717356592e-01,0.0000000000000000e+00,3.9432647664436571e-01,-6.5137238788824792e-01,-4.3509838056626693e-01,6.0604691660264329e+00,-2.1282680209104505e+01,4.5199362852326075e+01,-4.0490077235428650e+01,};
    ++i; //2
    reresN16[i] = a_t{-2.5319821851691640e+02,-3.5082276561342567e+01,1.5298918825597735e+01,1.3947149207633325e+01,6.0908200143966242e+00,1.7162267487109166e+00,2.5907919795880152e-01,-9.0479447254122186e-03,4.2742062973579300e-03,-1.7950508129637825e-02,3.5267209806377375e-02,1.0729520428477559e+00,5.4817565240670598e+00,1.6761694673247746e+01,3.2576662303064147e+01,1.8644043543740850e+01,};
    imresN16[i] = a_t{1.6938838583391137e+02,-1.1033000331784777e+02,4.1149408557235461e+01,-8.8737866872923394e+00,-3.2861942288843826e-01,1.2399082471431149e+00,-5.4958024784227133e-01,8.9989821222477215e-02,0.0000000000000000e+00,1.5975052786945548e-01,-7.5708449492624763e-01,2.0631988962923691e+00,-3.2106644901281740e+00,-1.5505696022518389e+00,2.9936441742684426e+01,-1.1454219445769864e+02,};
    ++i; //3
    reresN16[i] = a_t{-9.5506545638894224e+01,-7.5521335842435874e+01,-3.0785141686569123e+01,-8.0498853105568937e+00,-9.6321608031380435e-01,2.2775239517797408e-01,1.2666383697293021e-01,1.3891258699268281e-02,1.9263964929954066e-04,-2.7337173336069016e-02,-2.3154996092692548e-01,-7.0431392010362071e-01,-6.3142856264583980e-01,4.3525260527697114e+00,2.6961602681808507e+01,8.8584738727118307e+01,};
    imresN16[i] = a_t{-2.1626351067606498e+02,4.1915373605363754e+01,3.8461992574620716e+00,-7.1871281397542921e+00,3.3801796559115305e+00,-9.6381687928068860e-01,1.5174018637732303e-01,-3.7981370223092114e-03,0.0000000000000000e+00,2.0309274020186001e-02,-1.7258160846715262e-01,9.8296416908969986e-01,-3.8785672204818216e+00,1.0669014472397786e+01,-1.7807152699754205e+01,-4.0732579557297015e+00,};
    ++i; //4
    reresN16[i] = a_t{1.6459479479936601e+02,4.0212505527292578e+01,3.3353645985241087e+00,-2.2757012900106339e+00,-1.3181581943425171e+00,-3.6464922881891654e-01,-4.9034217684428574e-02,-1.0576096274504581e-03,6.6747981874213704e-06,-5.4758229233055527e-03,-8.2167758080657488e-02,-5.0450619866509128e-01,-1.9527078874081523e+00,-4.9488698993272191e+00,-5.5342767307188288e+00,1.9241966949938568e+01,};
    imresN16[i] = a_t{-3.1099829588622512e+01,4.1776214883628469e+01,-1.9055979797837843e+01,5.6103329404949953e+00,-1.0489340807890595e+00,7.7154698520917497e-02,1.1842718781598580e-02,-1.4236516351671018e-03,0.0000000000000000e+00,-9.2903668193886177e-04,2.5116757869633587e-02,-4.3300176271519442e-02,-5.7672914102554396e-01,4.7249483600718181e+00,-2.0260894608822824e+01,5.8319670131938238e+01,};
    ++i; //5
    reresN16[i] = a_t{-1.0005914193103791e+01,1.6548099573504999e+01,9.2337596729451388e+00,2.9420066221775354e+00,6.1252152196477450e-01,7.3105922471635970e-02,2.4596436680023722e-03,-9.4108515409285889e-05,1.8785389263193448e-07,-4.1721828665670924e-04,-7.3414912446273708e-03,-8.2917347870186536e-02,-6.3641505388989661e-01,-3.2935762492216409e+00,-1.2068629754506228e+01,-3.0651660103391919e+01,};
    imresN16[i] = a_t{1.0785448761545030e+02,-3.0882302976870236e+01,5.3444501868586531e+00,-2.6463123493584817e-02,-3.0498613586796569e-01,9.0900764393587241e-02,-1.0276490763979277e-02,1.5104699128218663e-04,0.0000000000000000e+00,-6.0653364093040286e-04,1.9579057796791026e-02,-1.5528683176959562e-01,6.3027893391268541e-01,-1.2861714628674055e+00,-1.3565322734275007e+00,2.3285871566764449e+01,};
    ++i; //6
    reresN16[i] = a_t{-5.8511065560919292e+01,-1.8919481916502960e+01,-4.1570711096657602e+00,-5.3386528539615807e-01,-7.9232473285402449e-04,1.2324214762527704e-02,1.4158641330301882e-03,1.4818040154163006e-05,4.4513283807380267e-09,1.5812642840954598e-05,2.2240317767216644e-03,2.4027694457514646e-02,8.0938046373379063e-02,-1.7525371429800485e-01,-3.2208550509156444e+00,-1.8735220545630220e+01,};
    imresN16[i] = a_t{-2.5839422107710050e+01,-2.5675047797686332e+00,3.1745162781774439e+00,-1.1321747547765961e+00,2.3988742997177950e-01,-2.8617538166711830e-02,1.2292761089912284e-03,2.7108358828688914e-06,0.0000000000000000e+00,-8.0645207520838619e-05,3.6807895173659160e-03,-4.6265390222767676e-02,3.3024395745442636e-01,-1.5929863080874878e+00,5.3719016592598248e+00,-1.1235938359759608e+01,};
    ++i; //7
    reresN16[i] = a_t{2.4227307334687360e+01,2.4089591039141061e+00,-5.1236639118426786e-01,-2.9320580765118121e-01,-6.5133354094637899e-02,-7.2174948777292327e-03,-2.6886545158065695e-04,-2.1504030689117501e-07,9.1083443671157897e-11,6.6120436841096451e-06,7.5863925896745845e-04,1.3293844011329700e-02,1.0716112091723032e-01,5.2165235739224136e-01,1.5467939499562162e+00,1.3213112365122730e+00,};
    imresN16[i] = a_t{-2.4633640100293860e+01,9.1045456874069526e+00,-2.2373168107088390e+00,3.6923692178685102e-01,-3.4622440730165488e-02,6.6786560454053278e-04,1.0442323575613845e-04,-1.0812382825925225e-06,0.0000000000000000e+00,-4.3660780276216210e-06,1.0190097692377829e-04,-1.8622368047739243e-03,3.6196677656832196e-02,-3.7651461870132541e-01,2.4483262415736502e+00,-1.1172303071020369e+01,};
    ++i; //8
    reresN16[i] = a_t{6.6746396523783655e+00,3.2801176331811894e+00,8.8473129778061599e-01,1.5599217646860397e-01,1.6839057045978267e-02,8.4210698357264533e-04,4.6305952515775426e-06,-5.9651121014823022e-08,1.6399765185867347e-12,6.5777197329092644e-07,8.7479137718271012e-05,2.1243983466014246e-03,2.6391924022400551e-02,2.1233162202020658e-01,1.2054895653801454e+00,4.9760002450853094e+00,};
    imresN16[i] = a_t{1.5764324158524166e+01,-2.6624488648798685e+00,2.0495577799832479e-01,3.0265595952830182e-02,-1.1094339320476121e-02,1.2318007010290917e-03,-3.8868231288046828e-05,3.8595229319813270e-08,0.0000000000000000e+00,1.3898163480933947e-07,-8.2219228878496661e-05,2.1949381884485918e-03,-2.0500574481310693e-02,9.0985269605787344e-02,-7.9325667437461167e-02,-1.7536583590516341e+00,};
    ++i; //9
    reresN16[i] = a_t{-7.8051472900584082e+00,-1.5659809251024250e+00,-2.1038222345951174e-01,-1.4447873990744240e-02,3.5807327302719806e-04,1.2164156411534451e-04,3.8938669586834496e-06,3.3336845652572784e-09,2.6362916994236531e-14,2.7569716725912351e-08,-1.1332312024513880e-06,-1.0123945262464662e-04,-5.5090199579053457e-04,1.1556952828234855e-02,2.0154887932836549e-01,1.6594867560096971e+00,};
    imresN16[i] = a_t{-1.5154020506139521e-01,-7.4078470994681556e-01,2.4951647194777829e-01,-4.6161356475667596e-02,4.9442535520961076e-03,-2.4700546174973633e-04,2.7228420228015466e-06,2.3702834151035740e-09,0.0000000000000000e+00,4.2825206941716276e-08,-1.6788286205108586e-05,6.1410741506335469e-04,-8.8532472276122692e-03,7.3981621068189701e-02,-4.1100123748108719e-01,1.5389905200236151e+00,};
    ++i; //10
    reresN16[i] = a_t{1.4647808558991533e+00,1.6082920816989088e-02,-3.9941789364220208e-02,-9.2437955347377879e-03,-9.9812015540565202e-04,-4.5934654838193650e-05,-4.6577747173920392e-07,5.0429777017223265e-11,3.8276105465439233e-16,-7.5268572639145830e-10,-1.7314626094759140e-06,-1.0173657383965304e-04,-1.8248175208267431e-03,-1.6471467685000976e-02,-8.6160774954110481e-02,-2.1303852669463413e-01,};
    imresN16[i] = a_t{-2.9446799017883998e+00,6.5257438104363041e-01,-9.9546485483834130e-02,9.7146382793989877e-03,-4.7725484359202347e-04,2.7835395959485273e-06,2.3482322809012395e-07,-2.0672726346606948e-10,0.0000000000000000e+00,3.4029405381642697e-09,-1.2431195201921135e-06,5.3125601647521012e-05,-1.1098090377648566e-03,1.4722490463558811e-02,-1.3312996747159492e-01,8.6656047668742187e-01,};
    auto v0 = T(1.0/3.0);
    auto h =  eve::half(eve::as(v0));
    using eve::spherical;
    for(int j=0; j <= 15; ++j)
    {
      auto c = kyosu::complex(re[j], im[j]);
      auto fac = kyosu::sqrt(eve::pio_2(eve::as(kyosu::real(c)))*kyosu::rec(c));
      for(int i=0; i < N; ++i)
      {
        auto res = kyosu::complex(reresN16[i][j], imresN16[i][j]);
        auto v = v0+i;
        //       std::cout<< "j " << j  << " c[" << j << "] = " << c << " i " << i << " v " << v << std::endl;
        TTS_RELATIVE_EQUAL(kyosu::bessel_j(v, c), res, tts::prec<T>());
        TTS_RELATIVE_EQUAL(kyosu::bessel_j[spherical](v, c), kyosu::bessel_j(v+h, c)*fac, tts::prec<T>());
      }
    }
 }
};


TTS_CASE_WITH ( "Check kyosu::bessel_jr over real negative order"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  auto constexpr N = 11;
  using a_t  = std::array<T, 16 >;
  using aN_t = std::array<a_t, N >;
  a_t re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
  a_t im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
  aN_t reresN16;
  aN_t imresN16;
  //res are taken from octave 9.2.0 besselj outputs
  int i=0; //0  -3.333e-01
  reresN16[i] = a_t{-8.9163143837610050e+01,-1.2219942089268812e+02,-6.0563369116851803e+01,-1.7842181975937766e+01,-1.1860080210885884e+00,2.3789187887624883e+00,1.9232059348460351e+00,1.1368224659946016e+00,1.3432948699326057e+00,5.5139655214064687e-01,-4.8990051277299940e-01,-3.4926635951494012e+00,-9.6925116789155155e+00,-1.5745152038061331e+01,-9.9352493046059109e-01,9.4517830645215696e+01,};
  imresN16[i] = a_t{-3.7583808427575212e+02,9.0801181249849066e+01,3.6018913915299962e+00,-1.6864299541716473e+01,1.0089846321224439e+01,-3.6425542565379301e+00,5.6128150602785309e-01,4.7851915025080155e-01,0.0000000000000000e+00,-7.8534132361994757e-01,1.7555311861860581e+00,-2.2254640329062294e+00,-1.3912074018251386e+00,1.7899970399493917e+01,-5.9204417397002132e+01,1.1533747474469016e+02,};
  ++i; //-1  -1.333e+00
  reresN16[i] = a_t{-3.5287547009834418e+02,-9.0023847682163108e+01,-6.8390846178912668e-01,1.3469061355222085e+01,8.4549467858162650e+00,3.2193201895359413e+00,8.2072102408875647e-01,4.0774653944889094e-01,-3.2936204648846306e+00,-7.9336518154825364e-01,-1.2836796662533640e+00,-1.3758657429174739e+00,2.2134525881257541e+00,1.7299033805074707e+01,5.3995102492591755e+01,1.0098665654625361e+02,};
  imresN16[i] = a_t{6.4365841232588764e+01,-1.0694095507081832e+02,5.4854661010524090e+01,-1.7031226246783568e+01,1.9820266872140397e+00,1.4271012496652797e+00,-1.1789131746432868e+00,2.7792371713590369e-01,0.0000000000000000e+00,2.4577619163987163e-01,-7.9086558355910785e-01,3.2135561671058306e+00,-8.2791954991543513e+00,1.2602560617681746e+01,3.1226751102621755e+00,-9.3933416851070788e+01,};
  ++i; //-2  -2.333e+00
  reresN16[i] = a_t{2.0095442780472325e+01,7.8007235988329327e+01,4.3285743181077677e+01,1.4659803247431750e+01,2.7691403315826104e+00,-1.8369436824820817e-01,-2.5430281224375550e-01,-1.2297802251078509e-01,2.7933331484597520e+01,1.7872210107052863e-01,7.2232403111359667e-01,2.3474800868719745e+00,5.5297122495460274e+00,7.0400045365270012e+00,-9.6372026810399980e+00,-8.9874544518020343e+01,};
  imresN16[i] = a_t{3.0397027952665820e+02,-8.5546960784270283e+01,7.3246061503724516e+00,7.6440777660208425e+00,-5.4426728247390237e+00,2.0980709625922986e+00,-3.8488352467409875e-01,-1.1603054780543189e+00,0.0000000000000000e+00,-6.0018050729755423e-01,-2.4151828843775730e-01,8.6325454802086643e-02,3.1417419008359939e+00,-1.5289731137953490e+01,4.3179639775586750e+01,-7.3417069223057922e+01,};
  ++i; //-3  -3.333e+00
  reresN16[i] = a_t{2.3504295316681126e+02,7.4060639020009532e+01,1.2062771060601545e+01,-2.1954647878138411e+00,-2.4368255904488212e+00,-9.4563058308105774e-01,-3.8179105720961670e-01,-5.2735378092250000e+00,-4.3122486929552133e+02,1.7767681294113136e+00,1.2481057981113673e-01,-4.8730047254291214e-01,-3.0471368935205509e+00,-1.1418768944412889e+01,-2.8903348358933670e+01,-4.0765108129755497e+01,};
  imresN16[i] = a_t{2.5420542856493924e+01,4.4446022529183630e+01,-2.8584232558913982e+01,1.0563845018988566e+01,-2.5126887141389749e+00,2.2285930926040537e-01,3.4412846429099692e-01,-1.6503427866626850e+00,0.0000000000000000e+00,1.5716632278856535e+00,9.0481567769940277e-02,-1.0524534487844015e+00,2.4739698780316228e+00,-1.5628884228202198e+00,-1.4445888625252458e+01,7.8753061234170218e+01,};
  ++i; //-4  -4.333e+00
  reresN16[i] = a_t{5.5364311006196687e+01,-1.6072506114105657e+01,-1.4834242498941355e+01,-5.9965914097589197e+00,-1.5830157232129383e+00,-3.7924524055609010e-01,-1.1637740802867258e+00,-2.1484826059975841e+01,9.5548415417491906e+03,-1.1340159958727051e+01,-7.5252707914364148e-01,-3.9315240825579867e-01,-4.9469887403120438e-01,1.6154660690967262e+00,1.4779689894513933e+01,6.0127668631253421e+01,};
  imresN16[i] = a_t{-1.5809323877131658e+02,5.5712984206370052e+01,-1.2415002637537128e+01,8.2766419384156564e-01,6.3996896042660101e-01,-3.3443343213919136e-01,-1.0781104179952454e-01,2.7674102573226243e+01,0.0000000000000000e+00,1.2838635123830746e+00,-1.4884438677382611e-01,3.9424674910659729e-01,-1.9653157776590613e+00,6.6428635390103512e+00,-1.4921673675765945e+01,1.2495477488359292e+01,};
  ++i; //-5  -5.333e+00
  reresN16[i] = a_t{-8.8401639520422549e+01,-3.5018965728901968e+01,-9.2472518126477823e+00,-1.5060113765121115e+00,-1.0179304465538710e-01,-2.4811900746583421e-01,-1.3890192129519365e+00,1.4782654811960802e+02,-2.7559753078123683e+05,4.1800516471412571e+01,1.1099155346499174e+00,3.4686379333891981e-01,9.0578440582528175e-01,2.7712004209333201e+00,4.8618383673625969e+00,-4.8400019080616001e+00,};
  imresN16[i] = a_t{-6.2592409557180133e+01,1.1092274891036027e+00,5.3269058826064768e+00,-2.5386979872417035e+00,6.6945796078445585e-01,1.5648829801793926e-01,-4.4132038302779506e+00,2.4487337276393984e+02,0.0000000000000000e+00,-5.6275764936029503e+01,2.1209519112272752e+00,-1.9566951842887442e-01,2.5742586033314746e-01,-2.2091224685899022e+00,1.1128580160188363e+01,-3.8187362766425338e+01,};
  ++i; //-6  -6.333e+00
  reresN16[i] = a_t{-5.1633399998941300e+01,-7.2376649127622823e+00,6.6498548091826626e-01,6.9572834776957848e-01,1.7726197710296573e-01,3.9915868771540713e-01,1.6106292880151130e+01,2.8169238330648764e+03,9.7894684751244560e+06,8.8541485103350681e+01,4.3984640522249219e+00,2.1576158713436491e-01,-2.4594023745160937e-01,-1.4761690458640284e+00,-6.2666074301823667e+00,-1.9099501100213949e+01,};
  imresN16[i] = a_t{3.7752657535113165e+01,-1.7668863103794543e+01,5.1854609212116287e+00,-1.0073922836222367e+00,-3.2820988188897976e-02,1.2285824158688592e+00,-1.5518676767202900e+01,-4.8631501304708337e+02,0.0000000000000000e+00,5.2178963732730779e+02,-8.8697515584781570e+00,6.9713408142352584e-01,1.2388600685748966e-01,-6.2510357002908490e-01,-1.0640638112734413e-01,1.0607348817652341e+01,};
  ++i; //-7  -7.333e+00
  reresN16[i] = a_t{9.2190476701992843e+00,6.6786891593457360e+00,2.1930681130828282e+00,4.9575819074362704e-01,4.2881443835567556e-01,4.8058763508422988e+00,1.1992148733180908e+02,6.8456423503852739e+03,-4.1305751586336255e+08,-3.9072309585322487e+03,-4.7468981631315103e+01,-2.5860404425922168e+00,-2.8359993342987022e-01,3.4145154863601035e-02,1.3445569847212508e+00,9.0154649621855381e+00,};
  imresN16[i] = a_t{3.3297993326296002e+01,-6.6361108212421360e+00,6.6217175960486574e-01,1.2962413400027425e-01,-3.1251673768774424e-01,8.9282942654288799e-01,4.1226867939196971e+01,-3.3128521032183744e+04,0.0000000000000000e+00,-2.6876291991490320e+03,9.4273152735136438e+00,-6.8467843307311116e-01,3.9191925490526636e-02,6.0155685667335701e-01,-2.5538720994218123e+00,6.7281333300540824e+00,};
  ++i; //-8  -8.333e+00
  reresN16[i] = a_t{1.6989711816489745e+01,3.9492030774762128e+00,6.4671889758415935e-01,2.3427602923347729e-01,1.3534126903452390e+00,1.3175974517360137e+01,1.2312823099766432e+02,-3.8706164223803865e+05,2.0184133529289391e+10,4.8273766337892950e+04,2.0751656110943853e+02,7.9925361523279106e+00,8.3920861967427074e-01,3.0940452286425796e-01,6.9360288368063150e-01,9.7306129219749038e-01,};
  imresN16[i] = a_t{2.1003732811258136e+00,1.5144299448345522e+00,-6.7723560192462395e-01,1.4837105872288553e-01,6.4846892833791625e-01,-1.6578897985830405e+01,8.1836392906767526e+02,-2.5361432682126111e+05,0.0000000000000000e+00,-9.4655358728043338e+03,1.7684784546737643e+02,-6.7733602758601394e+00,4.5619741949614173e-01,-1.6147834651750892e-01,9.9946493946278980e-01,-5.1831584685517980e+00,};
  ++i; //-9  -9.333e+00
  reresN16[i] = a_t{4.0365512689526932e+00,1.5505841054991387e-01,-4.9731098135866958e-02,2.0966111835661888e-01,1.6268819273903123e-01,-4.0236077639299538e+01,-4.9225024343501054e+03,-5.8752218451733263e+06,-1.1209276941113259e+12,-3.1949468958387274e+05,4.9688471347589036e+01,3.8710382542379422e+00,-2.2190380404616175e-01,-1.8980161797069911e-01,-4.9253427058378857e-01,-2.1720951216548596e+00,};
  imresN16[i] = a_t{-6.6845946724625138e+00,1.7239947541348308e+00,-2.5889943714214314e-01,-4.5907587362104363e-01,5.5820471363587165e+00,-9.5350808629395772e+01,3.6262612445680702e+03,4.1368054105369844e+06,0.0000000000000000e+00,4.8384848095495958e+05,-1.7406185574443339e+03,4.6115655306433631e+01,-3.1441291109227310e+00,3.1149264091278289e-01,-1.1819613071950230e-02,6.7232543766749919e-01,};
  ++i; //-10  -1.033e+01
  reresN16[i] = a_t{-1.8134464605395135e+00,-5.4864725184664043e-01,-1.5118456804639460e-01,-1.0947562808829852e+00,-1.9744457058298579e+01,-5.5987348202770443e+02,-4.5508119232122983e+04,2.9138824187694438e+07,6.9726427944508648e+13,-1.5822424858013659e+06,-9.8678755793027376e+03,-1.9470657483458658e+02,-9.5046052155909262e+00,-7.0518000588838103e-01,1.8380797474564808e-02,6.4434414292540554e-01,};
  imresN16[i] = a_t{-2.7360294518865507e+00,3.0673193149368211e-01,2.0041931574682351e-01,-1.4818132616432789e+00,1.1605145367748406e+01,-6.1081790098068453e+01,-2.1799974932382960e+04,1.2142512712157235e+08,0.0000000000000000e+00,-7.4884040558229461e+06,7.5706982540860963e+03,-1.1851141042135517e+02,7.2950360278880195e+00,-8.4790372767143407e-01,-1.1238585129570294e-03,5.9240599118251991e-01,};
  using eve::spherical;
  auto v0 = T(-1.0/3.0);
  auto h =  eve::half(eve::as(v0));
  for(int j=0; j <= 15; ++j)
  {
    auto c = kyosu::complex(re[j], im[j]);
    auto fac = kyosu::sqrt(eve::pio_2(eve::as(kyosu::real(c)))*kyosu::rec(c));

    for(int i=0; i < N; ++i)
    {
      auto res = kyosu::complex(reresN16[i][j], imresN16[i][j]);
      auto v = v0-i;
      // std::cout<< "j " << j  << " c[" << j << "] = " << c << " i " << i << " v " << v << std::endl;
      if( ((i < 7) || (sizeof(T) == 8 ) || kyosu::is_not_real(c)) ) // The limitation of these tests with float is due to some overflow pbs when z is real
        TTS_RELATIVE_EQUAL(kyosu::bessel_j(v, c), res, tts::prec<T>());
      TTS_RELATIVE_EQUAL(kyosu::bessel_j[spherical](v, c), kyosu::bessel_j(v+h, c)*fac, tts::prec<T>());
    }
  }
};
