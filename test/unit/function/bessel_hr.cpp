//======================================================================================================================
/*
  Kyosu - Complex Without Complexes
  Copyright : KYOSU Contributors & Maintainers
  SPDX-License-Identifier: BSL-1.0
*/
//======================================================================================================================
#include <kyosu/kyosu.hpp>
#include <test.hpp>

TTS_CASE_TPL ( "Check kyosu::bessel_hr over real positive order first kind"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  if constexpr(sizeof(T) == 8)
  {
    auto constexpr N = 11;
    using a_t  = std::array<T, 16 >;
    using aN_t = std::array<a_t, N >;
    a_t re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
    a_t im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
    aN_t reresN16;
    aN_t imresN16;
    //res are taken from octave 9.2.0 besselh outputs
    int i=0;
    reresN16[i] = a_t{1.4592745005761237e-05,3.5072795151919706e+01,7.3352783961249236e-04,-4.7049943134827863e+01,1.0242147499438968e-03,-3.9203110014578639e+00,-6.6828582150730481e-02,1.7391034227246114e+00,5.8501480583737409e-01,1.7891510294989266e-01,2.5802712856302996e+00,1.6115533951545476e-02,-1.2095976609063673e+01,-9.3243347193101096e-04,-1.0353865856090871e+02,-2.3537668719273835e-04,};
    imresN16[i] = a_t{-8.4648103620906269e-05,3.0245703282366736e+02,3.9271258847814179e-06,1.4039989968151970e+01,6.5703630981507402e-03,-7.7813978484722766e+00,2.0184694363190515e-02,-1.6377141213582707e+00,-1.2133448538831417e+00,-1.5862309536715846e-01,2.6624314493685595e+00,1.1837222855275161e-02,1.5394934001850938e+01,1.9117728141976376e-03,-5.7484294823231480e+01,-6.7457374883424218e-05,};
    ++i; //1   1.333e+00
    reresN16[i] = a_t{-9.1441228146294412e-05,2.7525075132299582e+02,-4.1453004465808472e-05,1.6028926089207605e+01,7.4521932435814833e-03,-5.6701490335781335e+00,3.7765031931952811e-02,-5.7984867479098057e-01,6.6295013865157237e-02,-1.5325851218427258e-01,2.5870024907973743e+00,1.5950925503392624e-02,1.2129155804725595e+01,2.0392293012915300e-03,-5.9402963141571881e+01,-8.5841510594792812e-05,};
    imresN16[i] = a_t{-1.1637946694794650e-05,-4.8984983093594053e+01,-8.0498062458774075e-04,4.0362575791530475e+01,-1.7764524738922499e-03,4.1629613928484668e+00,8.4390442282067629e-02,8.4781375336605236e-02,-3.7648698799182263e+00,-3.1496361557791025e-01,-1.3843992568302301e+00,-1.7264038968968710e-02,1.2119808152686005e+01,1.1811307285080853e-03,9.0399457700866861e+01,2.4957450820527725e-04,};
    ++i; //2   2.333e+00
    reresN16[i] = a_t{-3.2549975668933479e-06,-7.0164341120396500e+01,-9.7661666497783953e-04,2.7897053052110003e+01,-4.1087142860664729e-03,3.4230090585156043e+00,1.3195428883735219e-01,-1.4008089524262526e+00,4.2742062973601946e-03,-8.0321127329947084e-01,1.9348884906382435e-01,-1.8556346182577795e-02,1.0963205596064107e+01,1.8556738361939086e-03,6.5152402900237917e+01,2.8098937182693159e-04,};
    imresN16[i] = a_t{1.0761725532475446e-04,-2.2065976252752498e+02,1.7250416814305392e-04,-1.7749079040180707e+01,-9.6106797171284560e-03,2.4428842084152409e+00,-1.0635720895010295e-01,2.2676877670166667e-01,-3.2252165189834493e+01,-5.6983709157691909e-02,-1.5707909094621098e+00,-2.7968473087561112e-02,-6.4309325969592095e+00,-2.2976990980466535e-03,5.9872669616924895e+01,1.3404261131446022e-04,};
    ++i; //3   3.333e+00
    reresN16[i] = a_t{1.3594353898654487e-04,-1.5104303421994103e+02,4.8286171390931980e-04,-1.6098472475150491e+01,-1.3360703567879117e-02,5.2687656549436623e-01,-3.5830872346734033e-01,1.9217358184012330e+00,1.9263964918536658e-04,-1.8538631135491053e+00,-2.3638903783858511e-01,-5.6559983800867339e-02,-1.2488310839277683e+00,-2.5642215999540554e-03,5.3923242459458081e+01,2.3309822713791785e-04,};
    imresN16[i] = a_t{-1.5946085656183541e-05,8.3830969776289692e+01,1.2776557028766672e-03,-1.4369835963231258e+01,1.0262771426989161e-02,-1.9242441160076860e+00,-2.1598475255809280e-01,-6.0851349625483504e+00,-4.9793547751750742e+02,2.0561612652420624e+00,-1.6214819703581421e-01,1.3642219726109964e-02,-7.7616532825628752e+00,-3.3120871226059176e-03,-3.5615576044652101e+01,-3.2751005237214827e-04,};
    ++i; //4   4.333e+00
    reresN16[i] = a_t{-5.8139250225350043e-05,8.0424809476316227e+01,1.7294349339375039e-03,-4.5591242332227715e+00,2.6416682713828084e-02,-7.9536497892235836e-01,-1.8036108257006078e-01,3.1955065476494347e+01,6.6747970777214505e-06,1.4775384456093121e+00,-2.6853961854032798e-01,-2.4269896791113216e-02,-3.8890843491357092e+00,-6.3020020466156446e-03,-1.1066708401218747e+01,-3.7571667197491170e-04,};
    imresN16[i] = a_t{-1.8022984865118056e-04,8.3551847237661875e+01,-1.1983490584216334e-03,1.1220723517401197e+01,1.7936038729575991e-02,3.0453905155041217e-01,1.3273433570608928e+00,2.4806505955600425e+01,-1.1032980668532542e+04,1.3090398305128224e+01,8.4662060405518702e-01,1.1939633159942463e-01,-1.1328965092899090e+00,2.3374517913982021e-03,-4.0522226647346869e+01,-4.2640977441288179e-04,};
    ++i; //5   5.333e+00
    reresN16[i] = a_t{-2.4263706285230051e-04,3.3097179931543693e+01,-2.8411716495666617e-03,5.8887210463004749e+00,1.5581881867161199e-02,-1.6007278029191194e-01,5.1043216171762413e+00,-2.8275559668080132e+02,1.8786522559821606e-07,6.4981589033411737e+01,-2.4677097793047236e+00,2.3267724452782435e-01,-1.2975565455683651e+00,-1.2990508466274517e-04,-2.4135612983644620e+01,-7.9597510331779050e-04,};
    imresN16[i] = a_t{1.4961473296137568e-04,-6.1764671814178058e+01,-2.2428269270535666e-03,-6.6886955485530475e-02,-6.8887153744001284e-02,-1.5339466309098229e-01,-1.6127576478448733e+00,1.7069549141387242e+02,-3.1823261716897838e+05,4.8266231459339885e+01,1.2969605112662075e+00,1.9736462402978275e-01,1.3087542722950063e+00,1.2188021056430937e-02,-2.7103915306351301e+00,3.7454596679794270e-04,};
    ++i; //6   6.333e+00
    reresN16[i] = a_t{3.4572971425641510e-04,-3.7839378079258758e+01,-2.2244199507204586e-03,-1.0434402982138904e+00,-1.7718980973412859e-01,1.4474913351736780e+00,-1.7918718276782194e+01,-5.6154819413444216e+02,1.8626451492309570e-09,6.0251083751573265e+02,-1.0241807972906903e+01,8.5572012909906392e-01,3.3322847454816951e-02,2.2649930636321192e-02,-6.4451914255242473e+00,1.6288149474651830e-04,};
    imresN16[i] = a_t{3.1321725003366729e-04,-5.1333371858146872e+00,6.5710611407823983e-03,-2.2437599187463064e+00,3.4745480679015332e-02,-4.8241090105975221e-01,-1.8595898334357106e+01,-3.2527034553473268e+03,-1.1303904518672930e+07,-1.0223897203351152e+02,-5.0739439742835639e+00,-2.8153301518532864e-01,6.6096088491027405e-01,1.0364104784058531e-02,1.0748395102035909e+01,1.4812180859084219e-03,};
    ++i; //7   7.333e+00
    reresN16[i] = a_t{3.3525688968472127e-04,4.8151679384731114e+00,1.4738984425685640e-02,-6.5606190115663066e-01,3.1571916664149113e-01,-1.0385537067742066e+00,-4.7605015759315982e+01,3.8253521071980183e+04,0.0000000000000000e+00,3.1034068923539885e+03,-1.0885026215094639e+01,8.0496756221804611e-01,4.1008021864257449e-02,4.4415147586825528e-02,3.0822096234737573e+00,2.6642435331510009e-03,};
    imresN16[i] = a_t{-7.5838074914384495e-04,1.8207244842482769e+01,-7.9475370368057695e-04,7.7240671956906959e-01,4.2292506258416751e-01,5.5458488526957304e+00,1.3847335517897559e+02,7.9046669063363061e+03,-4.7695773594902158e+08,-4.5116816919378844e+03,-5.4811918744437115e+01,-2.9802893237180221e+00,-2.2940681615073405e-01,-3.5911061033467563e-02,4.8939288191009744e+00,7.1857263820350502e-04,};
    ++i; //8   8.333e+00
    reresN16[i] = a_t{-1.5949856246814005e-03,6.5659962746613063e+00,-1.5604289970644773e-02,3.0984246788526837e-01,7.7203179751314366e-01,-1.9143531503455790e+01,9.4496529655578252e+02,-2.9284859972128330e+05,-3.8146972656250000e-06,-1.0929859367797744e+04,2.0420643732082175e+02,-7.8203456069796875e+00,5.6499934211714686e-01,-2.6657881539343987e-02,2.4053709645176786e+00,3.4794966086711030e-03,};
    imresN16[i] = a_t{-1.0022284046576758e-04,-5.3288189861198525e+00,-3.1011028288015500e-02,-1.5019093605679520e-01,-1.5641586673930385e+00,-1.5212586877472354e+01,-1.4217627081744354e+02,4.4694028667822428e+05,-2.3306629852989143e+10,-5.5741743979440376e+04,-2.3961951654880448e+02,-9.2255643379629362e+00,-9.7429783499293388e-01,-1.4369458039171071e-01,-1.8423956556737731e-01,-4.3576760404479067e-03,};
    ++i; //9   9.333e+00
    reresN16[i] = a_t{1.0495552663737154e-03,-3.1289863441655665e+00,-5.5489306251689192e-02,5.4229855602378452e-01,-6.4480893264579828e+00,1.1010189430949416e+02,-4.1872458090847267e+03,-4.7767714347172491e+06,2.4414062500000000e-04,-5.5870010145267146e+05,2.0098931939533772e+03,-5.3250227804584888e+01,3.6350880997906261e+00,-3.9083707617373420e-01,4.5248866800295512e-01,-5.3843798469432160e-03,};
    imresN16[i] = a_t{3.1638294138413839e-03,-1.4658581884583011e+00,7.0627712809040594e-02,1.8759296583014221e-01,1.9300713099637301e-01,-4.6460797288040425e+01,-5.6840162061462734e+03,-6.7841218277191715e+06,-1.2943358118745601e+12,-3.6892069007175090e+05,5.7375287173746074e+01,4.4704456130450474e+00,-2.6540375264368476e-01,-1.3850999956143639e-01,-8.6336652515932055e-01,-1.1023761063380348e-02,};
    ++i; //10   1.033e+01
    reresN16[i] = a_t{5.5979087590833304e-03,-6.4975473109435411e-03,2.4895569262121148e-01,-1.7259031155574398e+00,1.3399745027165595e+01,-7.0531223453140399e+01,-2.5172442791678186e+04,1.4020965966004884e+08,-1.5625000000000000e-02,-8.6468641948601417e+06,8.7418893488863396e+03,-1.3684532182627771e+02,8.4223979599242202e+00,-1.0040463923532590e+00,-1.0595872427152209e-02,-2.9295934221659700e-02,};
    imresN16[i] = a_t{-5.0006760242808489e-03,1.2953831367942881e+00,5.1966013792624541e-02,1.2684933973687360e+00,2.2797881675439417e+01,6.4648618738481173e+02,5.2548249777925565e+04,-3.3646615977269173e+07,-8.0513143886786344e+13,1.8270162502013682e+06,1.1394441241837576e+04,2.2482778117544080e+02,1.0972809391600464e+01,8.1948441661527371e-01,-2.0409923082465764e-01,-4.6190278497123399e-04,};
    auto v0 = T(1.0/3.0);
    auto h =  eve::half(eve::as(v0));
    using eve::spherical;
    using c_t = kyosu::complex_t<T>;
    std::array<c_t, 5> hs;
    for(int j=0; j <= 15; ++j)
    {
      auto c = kyosu::complex(re[j], im[j]);
      auto hv = kyosu::bessel_h(v0+N-1, c, std::span(hs));
      TTS_RELATIVE_EQUAL(hv, kyosu::bessel_h(v0+(N-1), c), tts::prec<T>());
       auto fac = kyosu::sqrt(eve::pio_2(eve::as(kyosu::real(c)))*kyosu::rec(c));
      for(int i=0; i < N; ++i)
      {
        auto res = kyosu::complex(reresN16[i][j], imresN16[i][j]);
        auto v = v0+i;
        //       std::cout<< "j " << j  << " c[" << j << "] = " << c << " i " << i << " v " << v << std::endl;
        TTS_RELATIVE_EQUAL(kyosu::bessel_h(v, c), res, tts::prec<T>());
        TTS_RELATIVE_EQUAL(kyosu::bessel_h[spherical](v, c), kyosu::bessel_h(v+h, c)*fac, tts::prec<T>());
        if (i < 5) TTS_RELATIVE_EQUAL(kyosu::bessel_h(v, c), hs[i], tts::prec<T>()) << i << " -- " <<  j <<  " -- "<< c << '\n';
      }
    }
 }
};


TTS_CASE_TPL ( "Check kyosu::bessel_hr over real positive order second kind"
              , kyosu::scalar_real_types
              , tts::generate(tts::randoms(-10,10))
              )
<typename T>(T )
{
  auto constexpr N = 11;
  using a_t  = std::array<T, 16 >;
  using aN_t = std::array<a_t, N >;
  a_t re{-5.2999999999999998e+00, -4.5999999999999996e+00, -3.8999999999999999e+00, -3.2000000000000002e+00, -2.5000000000000000e+00, -1.7999999999999998e+00, -1.1000000000000005e+00, -4.0000000000000036e-01, 2.9999999999999982e-01, 1.0000000000000000e+00, 1.7000000000000002e+00, 2.3999999999999995e+00, 3.0999999999999988e+00, 3.7999999999999998e+00, 4.4999999999999991e+00, 5.2000000000000002e+00};
  a_t im{8.0000000000000000e+00, -7.0000000000000000e+00, 6.0000000000000000e+00, -5.0000000000000000e+00, 4.0000000000000000e+00, -3.0000000000000000e+00, 2.0000000000000000e+00, -1.0000000000000000e+00, -0.0000000000000000e+00, 1.0000000000000000e+00, -2.0000000000000000e+00, 3.0000000000000000e+00, -4.0000000000000000e+00, 5.0000000000000000e+00, -6.0000000000000000e+00, 7.0000000000000000e+00};
  aN_t reresN16;
  aN_t imresN16;
  //res are taken from octave 9.2.0 besselh outputs
  int i=0; //0  -3.333e-01
  reresN16[i] = a_t{5.6180744753631052e+02,1.9134982242364628e-04,-6.6801657845416145e+01,1.6580782600501935e-03,-1.8655932281281185e+01,-1.1035884047036020e-02,9.3510401606779969e-01,-2.4074733650494051e-01,5.8501480583737409e-01,1.8637335471938534e+00,6.5299192284034066e-02,3.8026228294002218e-01,1.5458555674241878e-03,-4.6747620796876376e+01,-6.5488234528677820e-04,-1.0525271173742377e+02,};
  imresN16[i] = a_t{-5.3027323452680434e+02,1.6043676300228429e-04,-1.0129757428658570e+02,-1.4242564801839452e-03,8.0380183560714791e+00,-1.7756053559100392e-02,3.9603394956222089e+00,1.2258861597207744e-01,1.2133448538831417e+00,-6.4551052152940325e-02,3.6338500820839482e-03,-8.2829726838211197e+00,-6.2400547045694896e-03,-9.3696695058438326e+00,-2.9187925183355340e-04,2.7904732975689751e+02,};
  ++i; //1   1.333e+00
  reresN16[i] = a_t{4.6436032158572840e+02,-1.8401194070794588e-04,9.5694250503811674e+01,1.4685123921679617e-03,-5.0197882179533444e+00,2.2647486820919736e-02,-2.7706917574643990e+00,-1.4287005332731140e-01,6.6295013865157237e-02,8.6966628430889426e-01,8.4366135747888302e-03,6.9349326637537185e+00,7.1998131259603387e-03,4.5312839940833900e+00,2.7474041469263460e-04,-2.6368393384374588e+02,};
  imresN16[i] = a_t{5.4683247509394835e+02,1.9854590188925247e-04,-5.3670463397936459e+01,1.9583564046764864e-03,-1.6633766110438781e+01,-1.1153581027117804e-02,-2.3312759380516646e-01,-4.3960706968373697e-01,3.7648698799182263e+00,1.1036165688666415e+00,8.1654481053734393e-02,-8.5293272216356542e-01,1.1301793668608254e-03,-4.2566541548937508e+01,-7.3199621471759175e-04,-8.0980404045365489e+01,};
  ++i; //2   2.333e+00
  reresN16[i] = a_t{-5.0639643377883533e+02,-2.1200228863300447e-04,3.0598814267860462e+01,-2.7546368433509815e-03,1.2185748743079316e+01,9.4444389062294503e-03,3.8620410708025088e-01,1.3827130629754281e+00,4.2742062973601946e-03,7.6731025704019507e-01,-1.2295442945106949e-01,2.1644604318780898e+00,3.0745207001261956e-04,3.3521533672659295e+01,9.2170589038532199e-04,3.7287806098109868e+01,};
  imresN16[i] = a_t{3.3877666405056749e+02,-2.4410817059050864e-04,8.2298644610302787e+01,1.5056655960276868e-03,-6.4762816605974827e-01,3.6932285870989567e-02,-9.9280328673443963e-01,-4.6789134256712606e-02,3.2252165189834493e+01,3.7648476489660276e-01,5.6621919609614546e-02,4.1543662656722997e+00,9.6036167028628570e-03,-3.0988415054056357e+00,2.1386844398415007e-04,-2.2908452295800862e+02,};
  ++i; //3   3.333e+00
  reresN16[i] = a_t{-1.9101322722132741e+02,3.6253506929895387e-04,-6.1570766234852165e+01,-1.2981459632974918e-03,-1.9130714570597298e+00,-7.1371775138418234e-02,6.1163639741320075e-01,-1.8939533010026985e+00,1.9263964918536658e-04,1.7991887668769677e+00,-2.2671088401526585e-01,-1.3520678564063742e+00,-1.4026041363911303e-02,8.7076163271393767e+00,-3.7095841065336310e-05,1.7716924435600950e+02,};
  imresN16[i] = a_t{-4.3252700540604434e+02,-2.2256556218954547e-04,7.6911208592212539e+00,-4.4203162773269709e-03,6.7500965403960729e+00,-3.3896425536910531e-03,5.1946512531273903e-01,6.0775386885037319e+00,4.9793547751750742e+02,-2.0155427172016895e+00,-1.8301501989849103e-01,1.9522861184532900e+00,4.5188415992325542e-03,2.1341341031918176e+01,1.2706451436857013e-03,-8.1461884014070307e+00,};
  ++i; //4   4.333e+00
  reresN16[i] = a_t{3.2918964773798228e+02,2.0157826892107324e-04,6.6689997621142822e+00,7.7216532015021034e-03,-2.6627330713988626e+00,6.6066521284525268e-02,8.2292647201203439e-02,-3.1957180695749244e+01,6.6747970777214505e-06,-1.4884900914559260e+00,1.0420410237901279e-01,-9.8474250053906953e-01,-1.6331425680595806e-02,-9.8914377966078249e+00,-1.8450602189077779e-03,3.8484309616549112e+01,};
  imresN16[i] = a_t{-6.2199478947396358e+01,5.8252959506452872e-04,-3.8110761246617265e+01,-5.7636411207632847e-05,-2.1158042003076951e+00,-1.5022965450857714e-01,-1.3036579194976956e+00,-2.4809353258870757e+01,1.1032980668532542e+04,-1.3092256378492102e+01,-7.9638708831591998e-01,-2.0599668414246353e-01,-2.0561772761179729e-02,9.4475592683522418e+00,4.3742970122398592e-04,1.1663976667365091e+02,};
  ++i; //5   5.333e+00
  reresN16[i] = a_t{-2.0011585749144714e+01,-9.8078453368846620e-04,1.8470360517539852e+01,-4.7078019454045699e-03,1.2094611620623879e+00,3.0628462523518396e-01,-5.0994023298402364e+00,2.8275540846377044e+02,1.8786522559821606e-07,-6.4982423469985065e+01,2.4530267968154686e+00,-3.9851194026819758e-01,2.4726437788571858e-02,-6.5870225933586202e+00,-1.6465253678422311e-03,-6.1302524231680522e+01,};
  imresN16[i] = a_t{2.1570882561616764e+02,6.5860437588242656e-05,1.0691143200644362e+01,1.3960708498361292e-02,-5.4108511799193026e-01,3.3519619187815669e-01,1.5922046663169171e+00,-1.7069518931988998e+02,3.1823261716897838e+05,-4.8267444526621730e+01,-1.2578023956726265e+00,-5.0793828756897397e-01,-4.8196404469635412e-02,-2.5845309467912418e+00,-2.6730162198718168e-03,4.6571368587562105e+01,};
  ++i; //6   6.333e+00
  reresN16[i] = a_t{-1.1702247685155285e+02,4.1424625283479878e-04,-8.3119177993808009e+00,-2.4290272578425857e-02,1.7560516026842057e-01,-1.4228429056486225e+00,1.7921550005048253e+01,5.6154822377052255e+02,1.8626451492309570e-09,-6.0251080589044693e+02,1.0246256036460347e+01,-8.0766474018403467e-01,1.2855324529194118e-01,-3.7315735923233073e-01,3.4813236929587873e-03,-3.7470603972755185e+01,};
  imresN16[i] = a_t{-5.1679157432670131e+01,-1.6723737225788095e-03,6.3424614952141063e+00,-2.0589590806886653e-02,4.4502937926454367e-01,4.2517582472632875e-01,1.8598356886575086e+01,3.2527034607689975e+03,1.1303904518672930e+07,1.0223881074309654e+02,5.0813055533182956e+00,1.8900223473979333e-01,-4.7297000142124124e-04,-3.1963367209590343e+00,-4.5917835162595406e-03,-2.2473357937605119e+01,};
  ++i; //7   7.333e+00
  reresN16[i] = a_t{4.8454279412485036e+01,2.7502693550987695e-03,-1.0394717667942219e+00,6.9650285854268079e-02,-4.4598587483076707e-01,1.0241187170187460e+00,4.7604478028412771e+01,-3.8253521072410265e+04,0.0000000000000000e+00,-3.1034068791299001e+03,1.0886543493612596e+01,-7.7837987419538535e-01,1.7331421997020335e-01,9.9888956719765720e-01,1.1378276438675578e-02,2.6399582294913948e+00,};
  imresN16[i] = a_t{-4.9266521819838587e+01,1.8465323311348302e-03,-4.4738388677139973e+00,-3.3932875995367512e-02,-4.9216994404449832e-01,-5.5445131214866503e+00,-1.3847314633250409e+02,-7.9046669084987661e+03,4.7695773594902158e+08,4.5116816832057302e+03,5.4812122546390960e+01,2.9765648501084745e+00,3.0180017146439841e-01,-7.1711817636918340e-01,2.7236640463264654e-03,-2.2345324714678942e+01,};
  ++i; //8   8.333e+00
  reresN16[i] = a_t{1.3350874290381416e+01,-5.7610082989271658e-03,1.7850668855318768e+00,2.1418850519395322e-03,-7.3835368342118712e-01,1.9145215717422939e+01,-9.4496528729459192e+02,2.9284859972116404e+05,-3.8146972656250000e-06,1.0929859369113285e+04,-2.0420626236254628e+02,7.8245944036728892e+00,-5.1221549407234579e-01,4.5132112557975712e-01,5.6081662426120133e-03,9.9485209935619459e+00,};
  imresN16[i] = a_t{3.1528748539888802e+01,3.9212563601155343e-03,4.4092258428466513e-01,2.1072212796245560e-01,1.5419699887520866e+00,1.5215050478874414e+01,1.4217619308098108e+02,-4.4694028667814704e+05,2.3306629852989143e+10,5.5741743979718340e+04,2.3961935211034668e+02,9.2299542143398341e+00,9.3329668603031257e-01,3.2566511960328537e-01,2.5588230692455083e-02,-3.5029590420628209e+00,};
  ++i; //9   9.333e+00
  reresN16[i] = a_t{-1.5611344135383192e+01,-2.9755060392834447e-03,-3.6527514066733430e-01,-5.7119430400527327e-01,6.4488054730040369e+00,-1.1010165102636591e+02,4.1872458168724643e+03,4.7767714347172594e+06,2.4414062500000000e-04,5.5870010145272675e+05,-2.0098931962198396e+03,5.3250025325679637e+01,-3.6361899037822063e+00,4.1395098183020396e-01,-4.9390909346224150e-02,3.3243578918663377e+00,};
  imresN16[i] = a_t{-3.0624423953663005e-01,-1.5711231435330399e-02,4.2840523108651596e-01,-2.7991567878147711e-01,-1.8311862389218403e-01,4.6460303277117006e+01,5.6840162115919547e+03,6.7841218277191725e+06,1.2943358118745601e+12,3.6892069007183611e+05,-5.7375320750317314e+01,-4.4692173982149548e+00,2.4769725818846222e-01,2.8647324169781552e-01,4.1364050197146111e-02,3.0890048011106108e+00,};
  ++i; //10   1.033e+01
  reresN16[i] = a_t{2.9239638030392241e+00,3.8663388944921724e-02,-3.2883927134965196e-01,1.7074155244879643e+00,-1.3401741267476407e+01,7.0531131583830643e+01,2.5172442790746623e+04,-1.4020965966004884e+08,-1.5625000000000000e-02,8.6468641948601417e+06,-8.7418893523492643e+03,1.3684511835313003e+02,-8.4260475949658744e+00,9.7110345698325706e-01,-1.6172567748106878e-01,-3.9678111916760878e-01,};
  imresN16[i] = a_t{-5.8843591275525187e+00,9.7656252929726583e-03,-2.5105898476029281e-01,-1.2490641208099382e+00,-2.2798836185126600e+01,-6.4648618181773259e+02,-5.2548249777455916e+04,3.3646615977269165e+07,8.0513143886786344e+13,-1.8270162502013613e+06,-1.1394441244323814e+04,-2.2482767492423753e+02,-1.0975029009675994e+01,-7.9003943568815604e-01,-6.2160704118532167e-02,1.7335828561598152e+00,};
  using kyosu::kind_2;
  using eve::spherical;
  auto v0 = T(1.0/3.0);
  auto h =  eve::half(eve::as(v0));
  using c_t = kyosu::complex_t<T>;
  std::array<c_t, 5> hs;
  for(int j=0; j <= 15; ++j)
  {
    auto c = kyosu::complex(re[j], im[j]);
    auto hv = kyosu::bessel_h[kind_2](v0+N-1, c, std::span(hs));
    TTS_RELATIVE_EQUAL(hv, kyosu::bessel_h[kind_2](v0+(N-1), c), tts::prec<T>());
    auto fac = kyosu::sqrt(eve::pio_2(eve::as(kyosu::real(c)))*kyosu::rec(c));
    for(int i=0; i < N; ++i)
    {
      auto res = kyosu::complex(reresN16[i][j], imresN16[i][j]);
      auto v = v0+i;
//      std::cout<< "j " << j  << " c[" << j << "] = " << c << " i " << i << " v " << v << std::endl;
      if( ((i < 7) || (sizeof(T) == 8 ) || kyosu::is_not_real(c)) ) // The limitation of these tests with float is due to some overflow pbs when z is real
      TTS_RELATIVE_EQUAL(kyosu::bessel_h[kind_2](v, c), res, tts::prec<T>());
      TTS_RELATIVE_EQUAL(kyosu::bessel_h[kind_2][spherical](v, c), kyosu::bessel_h[kind_2](v+h, c)*fac, tts::prec<T>());
      if (i < 5)
        if (j!= 8) TTS_RELATIVE_EQUAL(kyosu::bessel_h[kind_2](v, c), hs[i], tts::prec<T>()) << i << " -- " <<  j <<  " -- "<< c << '\n';
    }
  }
};
